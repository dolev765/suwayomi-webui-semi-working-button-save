import{u as C,r as h,b as A,m as v,g as p,j as t,H as j,o as S,p as f,bI as u,a as T,e as N,f as E,bJ as P,bK as V,bL as W,bM as y,y as F}from"./index-B3NSCdsi.js";import{N as B}from"./NumberSetting-DZ-XTU9n.js";import{u as M,g as O}from"./usePersistedValue-hjQaLPKk.js";import{S as w}from"./Switch-Ba0YZzPv.js";import{T as D}from"./TextSetting-Bbq1hKUk.js";import{S as m}from"./SelectSetting-DYiz4PGL.js";import{E as R}from"./EmptyViewAbsoluteCentered-DBqm8ISe.js";import{u as H}from"./useAppTitle-CiigzFb7.js";import"./Slider-CwwfJui_.js";import"./SwitchBase-CZLmNsA7.js";import"./Select-CbmmqdPd.js";const q=({disabled:e=!1,updateCheckInterval:d})=>{const{t:n}=C(),l=!!d,[I]=h.useUpdateServerSettings(),[i,U]=M("lastUpdateCheckInterval",u.default,d,O),c=A.useCallback(s=>{U(s===0?i:s),I({variables:{input:{settings:{webUIUpdateCheckInterval:s}}}}).catch(b=>v(n("global.error.label.failed_to_save_changes"),"error",p(b)))},[i]),g=s=>{c(s?i:0)};return t.jsxs(j,{children:[t.jsxs(S,{children:[t.jsx(f,{primary:n("settings.webui.auto_update.label.title")}),t.jsx(w,{disabled:e,edge:"end",checked:l,onChange:s=>g(s.target.checked)})]}),t.jsx(B,{settingTitle:n("settings.webui.auto_update.label.interval"),settingValue:n("library.settings.global_update.auto_update.interval.label.value",{hours:i}),value:i,minValue:u.min,maxValue:u.max,defaultValue:u.default,showSlider:!0,valueUnit:n("global.time.hour_short"),handleUpdate:c,disabled:e||!l})]})},G=e=>({webUIFlavor:e.webUIFlavor,initialOpenInBrowserEnabled:e.initialOpenInBrowserEnabled,webUIInterface:e.webUIInterface,electronPath:e.electronPath,webUIChannel:e.webUIChannel,webUIUpdateCheckInterval:e.webUIUpdateCheckInterval}),se=()=>{const{t:e}=C();H(e("settings.webui.title.webui"));const{settings:{webUIInformAvailableUpdate:d},loading:n,request:{error:l,refetch:I}}=T(),i=F(a=>v(e("global.error.label.failed_to_save_changes"),"error",p(a))),{data:U,loading:c,error:g,refetch:s}=h.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[b]=h.useUpdateServerSettings(),o=(a,L)=>{a==="webUIChannel"&&h.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),b({variables:{input:{settings:{[a]:L}}}}).catch(k=>v(e("global.error.label.failed_to_save_changes"),"error",p(k)))};if(n||c)return t.jsx(N,{});const _=l!=null?l:g;if(_)return t.jsx(R,{message:e("global.error.label.failed_to_load_data"),messageExtra:p(_),retry:()=>{l&&I().catch(E()),g&&s().catch(E())}});const r=G(U.settings),x=r.webUIFlavor===P.Custom;return t.jsxs(j,{sx:{pt:0},children:[t.jsx(m,{settingName:e("settings.webui.flavor.label.title"),value:r.webUIFlavor,values:V,handleChange:a=>o("webUIFlavor",a)}),t.jsxs(S,{children:[t.jsx(f,{primary:e("settings.webui.label.initial_open_browser")}),t.jsx(w,{edge:"end",checked:r.initialOpenInBrowserEnabled,onChange:a=>o("initialOpenInBrowserEnabled",a.target.checked)})]}),t.jsx(m,{settingName:e("settings.webui.interface.label.title"),value:r.webUIInterface,values:W,handleChange:a=>o("webUIInterface",a)}),t.jsx(D,{settingName:e("settings.webui.electron_path.label.title"),dialogDescription:e("settings.webui.electron_path.label.description"),value:r.electronPath,settingDescription:r.electronPath.length?r.electronPath:e("global.label.default"),handleChange:a=>o("electronPath",a)}),t.jsx(m,{settingName:e("settings.webui.channel.label.title"),value:r.webUIChannel,values:y,handleChange:a=>o("webUIChannel",a),disabled:x}),t.jsx(q,{disabled:x,updateCheckInterval:r.webUIUpdateCheckInterval}),!r.webUIUpdateCheckInterval&&t.jsxs(S,{children:[t.jsx(f,{primary:e("global.update.settings.inform.label.title"),secondary:e("global.update.settings.inform.label.description")}),t.jsx(w,{edge:"end",checked:d,onChange:a=>i("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{se as WebUISettings};
