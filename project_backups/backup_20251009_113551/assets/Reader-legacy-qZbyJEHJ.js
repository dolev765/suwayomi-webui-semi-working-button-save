!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=["page","pagesIndex","isCurrentPage","isLeadingPage","isTrailingPage","totalPages","showDraggingStyle","primaryPageLoadState","secondaryPageLoadState","createProgressBarSlot"],r=["direction"],n=["title","type","disabled"],i=["pageScaleMode","shouldStretchPage","updateSetting"],a=["readingMode","setReadingMode"],o=["readingDirection","setReadingDirection"];function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=x(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function a(r,n,i,a){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return u(c,"_invoke",function(r,n,i){var a,s,l,u=0,c=i||[],d=!1,p={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,r){return a=t,s=0,l=e,p.n=r,o}};function g(r,n){for(s=r,l=n,t=0;!d&&u&&!i&&t<c.length;t++){var i,a=c[t],g=p.p,f=a[2];r>3?(i=f===n)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=g&&((i=r<2&&g<a[1])?(s=0,p.v=n,p.n=a[1]):g<f&&(i=r<3||a[0]>n||n>f)&&(a[4]=r,a[5]=n,p.n=f,s=0))}if(i||r>1)return o;throw d=!0,n}return function(i,c,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&g(c,f),s=c,l=f;(t=s<2?e:l)||!d;){a||(s?s<3?(s>1&&(p.n=-1),g(s,l)):p.n=l:p.v=l);try{if(u=2,a){if(s||(i="next"),t=a[i]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),s=1);a=e}else if((t=(d=p.n<0)?l:r.call(n,p))!==o)break}catch(t){a=e,s=1,l=t}finally{u=1}}return{value:t,done:d}}}(r,i,a),!0),c}var o={};function s(){}function c(){}function d(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(u(t={},n,function(){return this}),t),g=d.prototype=s.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e}return c.prototype=d,u(g,"constructor",d),u(d,"constructor",c),c.displayName="GeneratorFunction",u(d,i,"GeneratorFunction"),u(g),u(g,i,"Generator"),u(g,n,function(){return this}),u(g,"toString",function(){return"[object Generator]"}),(l=function(){return{w:a,m:f}})()}function u(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}u=function(e,t,r,n){function a(t,r){u(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},u(e,t,r,n)}function c(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function d(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){f(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function f(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,r||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./index-legacy-DbvsbuFI.js","./ReaderSettingsTabs-legacy-C_Zk1l3B.js","./PushPin-legacy-Bzph2VOk.js","./PushPinOutlined-legacy-a52IKAge.js","./Link-legacy-BEiZM1k4.js","./Select-legacy-SzY7YSW6.js","./useManageMangaLibraryState-legacy-DIx9sI96.js","./index-legacy-DjwQxBgp.js","./ChapterListCard-legacy-4nsfrS_k.js","./Download-legacy-Cg_PYvmM.js","./Delete-legacy-C2eSwLaM.js","./ChapterCardMetadata-legacy-DPPY4lD9.js","./Favorite-legacy-D98akXpI.js","./CheckboxInput-legacy-DOO1YABB.js","./EmptyViewAbsoluteCentered-legacy-CZb4FyHT.js","./use-window-event-legacy-CcT8Nyqn.js","./use-merged-ref-legacy-BACSs_PN.js","./useAppTitle-legacy-oE1eilGc.js","./TabsMenu-legacy-C_v6fSWI.js","./Tabs-legacy-DgZWmRBd.js","./Trans-legacy-CGoMohzr.js","./Slider-legacy-Dx30W6c-.js","./ListSubheader-legacy-D6CTP6K_.js","./Add-legacy-DQPcmnlz.js","./ThreeStateCheckboxInput-legacy-vZt-HlJP.js","./Checkbox-legacy-Do2WUkle.js","./SwitchBase-legacy-WgGrSGAu.js","./FormGroup-legacy-c7p8dI02.js","./DoneAll-legacy-D3tg1rkq.js","./MUI.util-legacy-D9xMlHDR.js","./ListCardContent-legacy-CjllcIlS.js","./Card-legacy--RZ2L8rK.js","./CardActionArea-legacy-tsqaDHd4.js"],function(e,u){"use strict";var p,x,m,b,S,C,y,j,P,w,T,E,I,D,M,L,O,R,k,A,N,B,_,W,z,V,H,F,U,G,X,Y,Z,q,K,J,$,Q,ee,te,re,ne,ie,ae,oe,se,le,ue,ce,de,pe,ge,fe,he,ve,xe,me,be,Se,Ce,ye,je,Pe,we,Te,Ee,Ie,De,Me,Le,Oe,Re,ke,Ae,Ne,Be,_e,We,ze,Ve,He,Fe,Ue,Ge,Xe,Ye,Ze,qe,Ke,Je,$e,Qe,et,tt,rt,nt,it,at,ot,st,lt,ut,ct,dt,pt,gt,ft,ht,vt,xt,mt,bt,St,Ct,yt,jt,Pt,wt,Tt,Et,It,Dt,Mt,Lt,Ot,Rt,kt,At,Nt,Bt,_t,Wt,zt,Vt,Ht,Ft,Ut,Gt,Xt,Yt,Zt,qt,Kt,Jt,$t,Qt,er,tr,rr,nr,ir,ar,or,sr,lr,ur,cr,dr,pr,gr,fr,hr,vr,xr,mr,br,Sr,Cr,yr,jr,Pr,wr,Tr,Er,Ir,Dr,Mr,Lr;return{setters:[function(e){p=e.c_,x=e.b,m=e.c$,b=e.d0,S=e.cV,C=e.j,y=e.i,j=e.aB,P=e.n,w=e.d1,T=e.d2,E=e.d3,I=e.E,D=e.d4,M=e.d5,L=e.d6,O=e.d7,R=e.d8,k=e.d9,A=e.S,N=e.z,B=e.T,_=e.cE,W=e.da,z=e.db,V=e.dc,H=e.a4,F=e.ae,U=e.dd,G=e.C,X=e.de,Y=e.df,Z=e.M,q=e.dg,K=e.c0,J=e.dh,$=e.di,Q=e.a,ee=e.cJ,te=e.dj,re=e.dk,ne=e.dl,ie=e.cK,ae=e.as,oe=e.dm,se=e.aY,le=e.dn,ue=e.dp,ce=e.bz,de=e.A,pe=e.L,ge=e.c,fe=e.u,he=e.c9,ve=e.dq,xe=e.b9,me=e.ba,be=e.aG,Se=e.a7,Ce=e.a8,ye=e.cb,je=e.ax,Pe=e.B,we=e.dr,Te=e.ds,Ee=e.dt,Ie=e.du,De=e.dv,Me=e.dw,Le=e.dx,Oe=e.dy,Re=e.dz,ke=e.dA,Ae=e.b2,Ne=e.dB,Be=e.bd,_e=e.dC,We=e.dD,ze=e.s,Ve=e.I,He=e.a6,Fe=e.ck,Ue=e.dE,Ge=e.dF,Xe=e.r,Ye=e.ca,Ze=e.aN,qe=e.bl,Ke=e.e,Je=e.aX,$e=e.dG,Qe=e.ab,et=e.ac,tt=e.m,rt=e.dH,nt=e.dI,it=e.ar,at=e.dJ,ot=e.dK,st=e.dL,lt=e.dM,ut=e.dN,ct=e.dO,dt=e.dP,pt=e.bn,gt=e.dQ,ft=e.b5,ht=e.dR,vt=e.dS,xt=e.dT,mt=e.dU,bt=e.dV,St=e.dW,Ct=e.dX,yt=e.dY,jt=e.dZ,Pt=e.d_,wt=e.f,Tt=e.d$,Et=e.e0,It=e.g,Dt=e.e1,Mt=e.e2,Lt=e.e3,Ot=e.e4,Rt=e.aJ,kt=e.e5,At=e.O,Nt=e.e6,Bt=e.e7,_t=e.e8,Wt=e.e9,zt=e.ea,Vt=e.eb,Ht=e.bm,Ft=e.ec,Ut=e.ed,Gt=e.ee,Xt=e.ef,Yt=e.eg,Zt=e.eh,qt=e.d,Kt=e.ei,Jt=e.ej,$t=e.aI,Qt=e.ek,er=e.el,tr=e.em},function(e){rr=e.R,nr=e.S,ir=e.D,ar=e.a,or=e.b,sr=e.c},function(e){lr=e.P},function(e){ur=e.P},function(e){cr=e.L},function(e){dr=e.S},function(e){pr=e.C,gr=e.c,fr=e.F,hr=e.l,vr=e.n,xr=e.a},function(e){mr=e.q},function(e){br=e.C,Sr=e.B,Cr=e.I,yr=e.b},function(e){jr=e.D},function(e){Pr=e.D},function(e){wr=e.D},function(e){Tr=e.F},function(e){Er=e.C},function(e){Ir=e.E},function(e){Dr=e.u},function(e){Mr=e.u},function(e){Lr=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var u=function(e){var t,r,n,i,a,o,s=e.isOpen,l=e.close,u=b().manga,c=S.useSettings();t=s,r=p(),n=r.activeScopes,i=r.enableScope,a=r.disableScope,o=x.useRef([]),x.useEffect(function(){return t?(o.current=v(n),i(m.NONE),o.current.forEach(a),function(){a(m.NONE),o.current.forEach(i)}):function(){}},[t]);var d=h(x.useState(0),2),f=d[0],T=d[1],E=h(x.useState(!1),2),I=E[0],D=E[1];return u&&s?C.jsx(y,{open:s,maxWidth:"md",fullWidth:!0,onClose:l,hideBackdrop:f===w.FILTER,sx:g({},j(I,{opacity:.75})),children:C.jsx(P,{sx:{p:0},children:C.jsx(rr,{activeTab:f,setActiveTab:T,settings:c,updateSetting:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=S).updateSetting.apply(e,[u].concat(r))},deleteSetting:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=S).deleteSetting.apply(e,[u].concat(r))},setTransparent:D})})}):null},Or=T(function(e){var t=e.isDesktop,r=e.scrollbarXSize,n=e.readerNavBarWidth,i=e.isMaximized,a=e.currentPageIndex,o=e.pages,s=e.totalPages,l=e.progressBarType,u=e.shouldShowPageNumber,c=e.readingDirection,d=x.useMemo(function(){var e=L(a,o).name,t="".concat(e).concat("/").concat(s);return c===R.LTR?t:O(t,"/")},[a,o,s,c]);return u?i||t&&l===k.STANDARD||i&&l===k.HIDDEN?null:C.jsx(A,{sx:{position:"fixed",left:n,right:0,bottom:function(e){return"max(calc(".concat(e.spacing(1)," + ").concat(r,"px), env(safe-area-inset-bottom))")},alignItems:"center",transition:function(e){return"left 0.".concat(e.transitions.duration.shortest,"s")}},children:C.jsx(N,{sx:{p:.5,borderRadius:1,backgroundColor:"rgba(0, 0, 0, 0.3)"},children:C.jsx(B,{sx:{color:"white"},children:d})})}):null},[S.useOverlayMode,E,I,D,M,S.useSettingsWithoutDefaultFlag],["isDesktop","scrollbarXSize","readerNavBarWidth","isMaximized","currentPageIndex","pages","totalPages","progressBarType","shouldShowPageNumber","readingDirection"]);function Rr(e){return e.substring(2).toLowerCase()}function kr(e){var t=e.children,r=e.disableReactTree,n=void 0!==r&&r,i=e.mouseEvent,a=void 0===i?"onClick":i,o=e.onClickAway,s=e.touchEvent,l=void 0===s?"onTouchEnd":s,u=x.useRef(!1),c=x.useRef(null),d=x.useRef(!1),p=x.useRef(!1);x.useEffect(function(){return setTimeout(function(){d.current=!0},0),function(){d.current=!1}},[]);var g=_(W(t),c),f=z(function(e){var t=p.current;p.current=!1;var r=V(c.current);!d.current||!c.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,r)||(u.current?u.current=!1:(e.composedPath?e.composedPath().includes(c.current):!r.documentElement.contains(e.target)||c.current.contains(e.target))||!n&&t||o(e))}),h=function(e){return function(r){p.current=!0;var n=t.props[e];n&&n(r)}},v={ref:g};return!1!==l&&(v[l]=h(l)),x.useEffect(function(){if(!1!==l){var e=Rr(l),t=V(c.current),r=function(){u.current=!0};return t.addEventListener(e,f),t.addEventListener("touchmove",r),function(){t.removeEventListener(e,f),t.removeEventListener("touchmove",r)}}},[f,l]),!1!==a&&(v[a]=h(a)),x.useEffect(function(){if(!1!==a){var e=Rr(a),t=V(c.current);return t.addEventListener(e,f),function(){t.removeEventListener(e,f)}}},[f,a]),x.cloneElement(t,v)}var Ar=H(B)({boxSizing:"content-box",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",textAlign:"center",userSelect:"none",cursor:"pointer"}),Nr=H(A,{shouldForwardProp:F(["progressBarPosition"])})(function(e){var t=e.theme,r=e.progressBarPosition;return g(g(g(g({position:"fixed",pointerEvents:"all",touchAction:"none"},j(U(r).isHorizontal,{justifyContent:"flex-end",bottom:0,right:0})),j(U(r).isVertical,{top:0,bottom:0})),j(U(r).isLeft,{alignItems:"ltr"===t.direction?"flex-start":"flex-end"})),j(U(r).isRight,{alignItems:"ltr"===t.direction?"flex-end":"flex-start"}))}),Br=H(A)(function(e){return{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:e.theme.spacing(.5)}}),_r=H(A)({flexDirection:"row",flexGrow:1,overflow:"hidden"}),Wr=H(N,{shouldForwardProp:F(["currentPagesIndex","pagesLength","progressBarPosition"])})(function(e){var t=e.currentPagesIndex,r=e.pagesLength,n=e.progressBarPosition;return g(g({position:"absolute",pointerEvents:"none"},j(U(n).isHorizontal,{left:0,width:"".concat((t+1)/r*100,"%"),height:"100%"})),j(U(n).isVertical,{top:0,width:"100%",height:"".concat((t+1)/r*100,"%")}))}),zr=function(e){var t=e.pageName,r=e.currentPagesIndex,n=e.pagesLength,i=e.isDragging,a=e.boxProps,o=e.children,s=e.progressBarPosition;return C.jsx(G,{title:t,slotProps:{tooltip:{sx:{backgroundColor:"primary.main",color:"primary.contrastText"}}},placement:X[s],children:C.jsx(N,g(g({},a),{},{sx:g(g(g({position:"absolute",cursor:i?"grabbing":"grab"},j(U(s).isHorizontal,{left:"".concat(Math.max(0,r-1)/(n-1)*100,"%"),width:"calc(100% / ".concat(n-1,")"),height:"100%"})),j(U(s).isVertical,{top:"".concat(Math.max(0,r-1)/(n-1)*100,"%"),width:"100%",height:"calc(100% / ".concat(n-1,")")})),null==a?void 0:a.sx),children:o}))})},Vr=H(A)({position:"relative",flexDirection:"row",flexGrow:1}),Hr=x.memo(H(N,{shouldForwardProp:F(["isFirstPage","isLastPage"])})(function(e){return{flexGrow:1,height:"100%",cursor:"pointer",borderLeftWidth:e.isFirstPage?0:void 0,borderRightWidth:e.isLastPage?0:void 0}})),Fr=x.memo(function(e){var r=e.page,n=e.pagesIndex,i=e.isCurrentPage,a=e.isLeadingPage,o=e.isTrailingPage,s=e.totalPages,l=e.showDraggingStyle,u=e.primaryPageLoadState,c=e.secondaryPageLoadState,p=e.createProgressBarSlot,f=d(e,t),h=x.useMemo(function(){return p(r,n,u,c,i,a,o,s,l)},[p,r,n,u,c,i,a,o,s,l]);return C.jsx(Hr,g(g({},f),{},{isFirstPage:0===n,isLastPage:n===s-1,children:h}))}),Ur=T(x.memo(function(e){var t,r,n,i,a,o,s,l,u,c,d,p,f,m,b,S,y,j,P,w,T=e.totalPages,E=e.pages,I=e.pageLoadStates,D=e.currentPageIndex,M=e.slotProps,O=e.slots,R=e.createProgressBarSlot,k=e.progressBarPosition,A=e.readingMode,N=e.isDragging,B=e.setIsDragging,_=e.openPage,W=e.direction,z=e.fullSegmentClicks,V=x.useRef(null),H=x.useRef(void 0),F=h(x.useState(0),2),G=F[0],X=F[1],Q=x.useRef(null);Z(Q,x.useCallback(function(){var e=Q.current;if(e){var t=getComputedStyle(e),r=t.paddingLeft,n=t.paddingRight,i=e.clientWidth-parseFloat(r)-parseFloat(n),a=A===q.DOUBLE_PAGE?2*i+6:i;X(a)}},[A]));var ee=x.useMemo(function(){return L(D,E).pagesIndex},[D,E]),te=U(k).isHorizontal,re=x.useMemo(function(){return L(D,E)},[D,E]),ne=x.useCallback(function(){return K(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],W)},[W]);Y.useHandleProgressDragging(_,V,N,re,E,k,ne,z);var ie=function(e){V.current&&(_(J($("touches"in e?e.touches[0]:e,V.current,E,te,z,ne)),void 0,!1),clearTimeout(H.current),H.current=setTimeout(function(){return B(!0)},250))},ae=function(){B(!1),clearTimeout(H.current)};return C.jsx(Nr,g(g({},null==M?void 0:M.container),{},{progressBarPosition:k,children:C.jsxs(Br,g(g({},null==M?void 0:M.progressBarRoot),{},{children:[C.jsx(Ar,g(g(g({},null==M||null===(t=M.progressBarPageTexts)||void 0===t?void 0:t.base),null==M||null===(r=M.progressBarPageTexts)||void 0===r?void 0:r.current),{},{sx:[{width:"".concat(G,"px")}].concat(v(Array.isArray(null==M||null===(n=M.progressBarPageTexts)||void 0===n||null===(n=n.base)||void 0===n?void 0:n.sx)?null!==(i=null==M||null===(a=M.progressBarPageTexts)||void 0===a||null===(a=a.base)||void 0===a?void 0:a.sx)&&void 0!==i?i:[]:[null==M||null===(o=M.progressBarPageTexts)||void 0===o||null===(o=o.base)||void 0===o?void 0:o.sx]),v(Array.isArray(null==M||null===(s=M.progressBarPageTexts)||void 0===s||null===(s=s.current)||void 0===s?void 0:s.sx)?null!==(l=null==M||null===(u=M.progressBarPageTexts)||void 0===u||null===(u=u.current)||void 0===u?void 0:u.sx)&&void 0!==l?l:[]:[null==M||null===(c=M.progressBarPageTexts)||void 0===c||null===(c=c.current)||void 0===c?void 0:c.sx])),onClick:function(){return _("previous","ltr",!1)},children:re.name})),C.jsx(kr,{onClickAway:function(){return B(!1)},children:C.jsxs(Vr,g(g({},null==M?void 0:M.progressBarSlotsActionArea),{},{onMouseDown:ie,onMouseUp:ae,onTouchStart:ie,onTouchEnd:ae,children:[C.jsxs(_r,g(g({ref:V},null==M?void 0:M.progressBarSlotsContainer),{},{children:[E.map(function(e,t){return x.createElement(Fr,g(g({},null==M?void 0:M.progressBarSlot),{},{key:e.primary.index,page:e,pagesIndex:t,isCurrentPage:t===ee,isLeadingPage:t<ee,isTrailingPage:t>ee,totalPages:E.length,primaryPageLoadState:I[e.primary.index].loaded,secondaryPageLoadState:e.secondary?I[e.secondary.index].loaded:void 0,createProgressBarSlot:R,showDraggingStyle:t===ee&&N}))}),C.jsx(Wr,g(g({},null==M?void 0:M.progressBarReadPages),{},{currentPagesIndex:re.pagesIndex,pagesLength:E.length,progressBarPosition:k}))]})),C.jsx(zr,{boxProps:null==M?void 0:M.progressBarCurrentPageSlot,pageName:re.name,currentPagesIndex:re.pagesIndex,pagesLength:E.length,isDragging:N,progressBarPosition:k,children:null==O?void 0:O.progressBarCurrentPage})]}))}),C.jsx(Ar,g(g(g({ref:Q},null==M||null===(d=M.progressBarPageTexts)||void 0===d?void 0:d.base),null==M||null===(p=M.progressBarPageTexts)||void 0===p?void 0:p.total),{},{sx:[{minWidth:"unset"}].concat(v(Array.isArray(null==M||null===(f=M.progressBarPageTexts)||void 0===f||null===(f=f.base)||void 0===f?void 0:f.sx)?null!==(m=null==M||null===(b=M.progressBarPageTexts)||void 0===b||null===(b=b.base)||void 0===b?void 0:b.sx)&&void 0!==m?m:[]:[null==M||null===(S=M.progressBarPageTexts)||void 0===S||null===(S=S.base)||void 0===S?void 0:S.sx]),v(Array.isArray(null==M||null===(y=M.progressBarPageTexts)||void 0===y||null===(y=y.total)||void 0===y?void 0:y.sx)?null!==(j=null==M||null===(P=M.progressBarPageTexts)||void 0===P||null===(P=P.total)||void 0===P?void 0:P.sx)&&void 0!==j?j:[]:[null==M||null===(w=M.progressBarPageTexts)||void 0===w||null===(w=w.total)||void 0===w?void 0:w.sx])),onClick:function(){return _("next","ltr",!1)},children:T}))]}))}))}),[D,function(){return{openPage:Y.useOpenPage()}},M,S.useSettingsWithoutDefaultFlag],["isDragging","setIsDragging","openPage","pages","pageLoadStates","totalPages","currentPageIndex","readingMode"]),Gr=x.forwardRef(function(e,t){var n=e.direction,i=d(e,r),a=Q().settings,o=a.customThemes,s=a.appTheme,l=a.themeMode,u=a.shouldUsePureBlackMode,c=x.useMemo(function(){return ee(l,te(s,o),u,n)},[l,s,o,u,n]);return C.jsx(re,{value:ne[n],children:C.jsx(ie,{theme:c,children:C.jsx(N,g(g({},i),{},{ref:t,dir:n}))})})}),Xr=T(Gr,[function(){return{direction:S.useGetThemeDirection()}}],["direction"]),Yr=x.memo(function(e){var t,r=e.pageName,n=e.progressBarPosition,i=e.slotProps,a=e.children;return C.jsx(G,g(g({},null==i?void 0:i.tooltip),{},{title:r,placement:X[n],children:C.jsx(N,g(g({},null==i?void 0:i.box),{},{sx:g({width:"100%",height:"100%"},null==i||null===(t=i.box)||void 0===t?void 0:t.sx),children:a}))}))}),Zr=x.memo(function(e){var t=e.pageName,r=e.primaryPageLoadState,n=e.secondaryPageLoadState,i=e.progressBarPosition,a=e.isCurrentPage,o=e.isLeadingPage,s=e.showDraggingStyle,l=ae();return C.jsx(Yr,{pageName:t,progressBarPosition:i,slotProps:{box:{sx:g(g({cursor:"pointer",backgroundColor:oe(l.palette.background.paper,.2)},l.applyStyles("dark",{backgroundColor:le(l.palette.background.paper,.1)})),j(r&&(null==n||n),g({backgroundColor:oe(l.palette.background.paper,.35)},l.applyStyles("dark",{backgroundColor:le(l.palette.background.paper,.25)}))))},tooltip:{slotProps:a?{tooltip:{sx:{backgroundColor:"primary.main",color:"primary.contrastText"}}}:void 0}},children:C.jsx(N,{sx:g(g({width:"100%",height:"100%"},j(o,{backgroundColor:se(l.palette.primary.main,.5)})),j(a,g({cursor:s?"grabbing":"grab",pointer:"grabbing",borderRadius:2,backgroundColor:"primary.dark"},l.applyStyles("dark",{backgroundColor:"primary.light"}))))})})}),qr=T(x.memo(function(e){var t=e.readerNavBarWidth,r=e.isMaximized,n=e.setIsMaximized,i=e.isDragging,a=e.progressBarType,o=e.progressBarSize,s=e.progressBarPosition,l=e.progressBarPositionAutoVertical,u=e.readerDirection,c=e.scrollbarXSize,d=e.scrollbarYSize,p=e.totalPages,f=ae(),v=h(x.useState({}),2)[1];Z(window.document.documentElement,x.useCallback(function(){return v({})},[]));var m=ue(s,l,d,t+c),b=U(m),S=b.isBottom,y=b.isLeft,P=b.isRight,w=b.isVertical,T=b.isHorizontal,E=!!p,I=a===k.HIDDEN,D=!r&&!i;return C.jsx(Xr,{children:C.jsx(Ur,{direction:T?u:"ltr",progressBarPosition:m,fullSegmentClicks:!0,createProgressBarSlot:x.useCallback(function(e,t,r,n,i,a,o,s,l){return C.jsx(Zr,{pageName:e.name,primaryPageLoadState:r,secondaryPageLoadState:n,progressBarPosition:m,isCurrentPage:i,isLeadingPage:a,showDraggingStyle:l})},[m]),slotProps:{container:{sx:g(g(g(g(g(g(g({overflow:"hidden",transition:"all 0.".concat(f.transitions.duration.shortest,"s")},j(T,g(g({minHeight:"100px"},j("ltr"===f.direction,{left:"ltr"===u?t:d,right:"rtl"===u?t:d})),j("rtl"===f.direction,{left:"rtl"===u?t:d,right:"ltr"===u?t:d})))),j(w,{minWidth:"100px",bottom:"".concat(c,"px")})),j(S,{bottom:"".concat(c,"px")})),j(y,g(g({},j("ltr"===f.direction,{left:"ltr"===u?t:"unset",right:"rtl"===u?t:"unset"})),j("rtl"===f.direction,{right:"rtl"===u?d:"unset",left:"ltr"===u?d:"unset"})))),j(P,g(g({},j("ltr"===f.direction,{right:"ltr"===u?d:"unset",left:"rtl"===u?d:"unset"})),j("rtl"===f.direction,{left:"rtl"===u?t:"unset",right:"ltr"===u?t:"unset"})))),j(D,{opacity:I?0:.85})),j(!E,{pointerEvents:"none"})),onMouseEnter:function(){return n(!0)},onMouseLeave:function(){return n(!1)}},progressBarRoot:{sx:g(g({gap:0,transition:"all 0.1s ease-in-out",backgroundColor:"background.paper"},j(w,{flexDirection:"column",height:"100%"})),j(D,g(g(g(g(g({backgroundColor:"unset",pointerEvents:"none"},j(T,{px:2})),j(w,{py:2})),j(S,{pb:.25})),j(y,g(g({},j("ltr"===f.direction,{pl:"ltr"===u?.25:0,pr:"rtl"===u?.25:0})),j("rtl"===f.direction,{pr:"rtl"===u?.25:0,pl:"ltr"===u?.25:0})))),j(P,g(g({},j("ltr"===f.direction,{pr:"ltr"===u?.25:0,pl:"rtl"===u?.25:0})),j("rtl"===f.direction,{pl:"rtl"===u?.25:0,pr:"ltr"===u?.25:0}))))))},progressBarSlotsContainer:{sx:g(g(g({gap:.25,borderRadius:2,transition:"height 0.1s ease-in-out"},j(T,{height:"20px"})),j(w,{flexDirection:"column",width:"20px"})),j(D,g(g({},j(T,{height:"".concat(o,"px")})),j(w,{width:"".concat(o,"px")}))))},progressBarReadPages:{sx:{display:"none"}},progressBarCurrentPageSlot:{sx:{display:"none"}},progressBarPageTexts:{base:{sx:g({px:1,py:1.5,transition:"all 0.1s ease-in-out"},j(D,{transform:"scale(0)",p:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0}))}}}})})}),[I,D,S.useSettingsWithoutDefaultFlag,function(){return{readerDirection:S.useGetThemeDirection()}},E,M],["readerNavBarWidth","isMaximized","setIsMaximized","isDragging","progressBarType","progressBarSize","progressBarPosition","progressBarPositionAutoVertical","readerDirection","scrollbarXSize","scrollbarYSize","totalPages"]),Kr=H(A)({width:"400px",minWidth:"400px",maxWidth:"400px",height:"100vh",overflowY:"auto"}),Jr=x.memo(function(e){var t=e.mangaId,r=e.mangaTitle,n=e.chapterTitle,i=e.scanlator;return C.jsxs(A,{children:[C.jsx(G,{title:r,placement:"right",children:C.jsx(ce,{lines:3,variant:"h6",component:"h1",sx:{textAlign:"center"},children:C.jsx(cr,{component:pe,to:de.manga.path(t),sx:{textDecoration:"none",color:"inherit"},children:r})})}),C.jsx(G,{title:n,placement:"right",children:C.jsx(ce,{lines:4,variant:"body1",component:"h2",sx:{textAlign:"center"},children:n})}),i&&C.jsx(G,{title:i,placement:"right",children:C.jsx(ce,{lines:4,variant:"body2",component:"h3",color:"textDisabled",sx:{textAlign:"center"},children:i})})]})}),$r=ge(C.jsx("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"})),Qr=ge(C.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"})),en=function(e){var t=e.title,r=e.type,i=e.disabled,a=d(e,n);return C.jsx(G,{title:t,disabled:i,children:C.jsx(pr,g(g({sx:{flexBasis:"15%"},variant:"contained",disabled:i},a),{},{children:"previous"===r?C.jsx($r,{}):C.jsx(Qr,{})}))})},tn=T(x.memo(function(e){var t=e.currentPageIndex,r=e.pages,n=e.readingDirection,i=e.openPage,a=fe().t,o=he(),s=x.useMemo(function(){return L(t,r)},[t,r]),l=ve[n];return C.jsxs(A,{sx:{flexDirection:"row",gap:1},dir:"ltr",children:[C.jsx(en,{type:"previous",title:a(o("reader.button.previous_page","reader.button.next_page",l)),disabled:o(!s.primary.index,J(s)===J(r.slice(-1)[0]),l),onClick:function(){return i("previous",void 0,!1)}}),C.jsxs(xe,{sx:{flexBasis:"70%",flexGrow:0,flexShrink:0},children:[C.jsx(me,{id:"reader-nav-bar-desktop-page-select",children:a("reader.page_info.label.page")}),C.jsx(dr,{labelId:"reader-nav-bar-desktop-page-select",label:a("reader.page_info.label.page"),value:J(s),onChange:function(e){return i(e.target.value,void 0,!1)},children:r.map(function(e){return C.jsx(be,{value:J(e),children:e.name},J(e))})})]}),C.jsx(en,{type:"next",title:a(o("reader.button.next_page","reader.button.previous_page",l)),disabled:o(J(s)===J(r.slice(-1)[0]),!s.primary.index,l),onClick:function(){return i("next",void 0,!1)}})]})}),[M,function(){return{openPage:Y.useOpenPage()}},S.useSettingsWithoutDefaultFlag],["currentPageIndex","pages","readingDirection","openPage"]),rn=function(){},nn=function(e){var t=e.currentChapter,r=e.chapters,n=e.style,i=x.useMemo(function(){return t&&r.findIndex(function(e){return e.id===t.id})},[t,r]);return C.jsx(mr,{style:g({height:"calc(".concat(r.length," * 100px)")},n),initialTopMostItemIndex:null!=i?i:0,totalCount:r.length,computeItemKey:function(e){return r[e].id},itemContent:function(e){return C.jsx(br,{index:e,chapters:r,isSortDesc:!0,mode:"reader",showChapterNumber:!1,selected:null,onSelect:rn,selectable:!1,isActiveChapter:e===i})},increaseViewportBy:400})},an=T(x.memo(function(e){var t,r,n=e.currentChapter,i=e.previousChapter,a=e.nextChapter,o=e.chapters,s=void 0===o?[]:o,l=e.readerThemeDirection,u=e.openChapter,c=fe().t,d=Se({variant:"popover",popupId:"reader-nav-bar-desktop-chapter-list"});return x.useLayoutEffect(function(){d.close()},[null==n?void 0:n.id]),C.jsxs(A,{sx:{flexDirection:"row",gap:1},dir:"ltr",children:[C.jsx(en,{type:"previous",title:c(K("reader.button.previous_chapter","reader.button.next_chapter",l)),onClick:function(){u(K("previous","next",l))},disabled:K(!i,!a,l)}),C.jsxs(xe,{sx:{flexBasis:"70%",flexGrow:0,flexShrink:0},children:[C.jsx(me,{id:"reader-nav-bar-desktop-chapter-select",children:c("chapter.title_one")}),C.jsx(dr,g(g({},Ce(d)),{},{open:d.isOpen,value:null!==(t=null==n?void 0:n.id)&&void 0!==t?t:0,MenuProps:{sx:{visibility:"hidden"}},label:c("chapter.title_one"),labelId:"reader-nav-bar-desktop-chapter-select",children:C.jsx(be,{value:null!==(r=null==n?void 0:n.id)&&void 0!==r?r:0,children:n?"#".concat(n.chapterNumber," ").concat(n.name):""},null==n?void 0:n.id)}))]}),C.jsx(en,{component:pe,type:"next",title:c(K("reader.button.next_chapter","reader.button.previous_chapter",l)),onClick:function(){u(K("next","previous",l))},disabled:K(!a,!i,l)}),C.jsx(ye,g(g({},je(d)),{},{anchorOrigin:{vertical:"bottom",horizontal:"left"},children:C.jsx(N,{sx:{mb:1},children:C.jsx(nn,{style:{width:"500px",maxWidth:"90vw",minHeight:"150px",maxHeight:"300px"},currentChapter:n,chapters:s})})}))]})}),[function(){return{readerThemeDirection:S.useGetThemeDirection()}},function(){return{openChapter:Y.useOpenChapter()}}],["readerThemeDirection","openChapter"]),on=ge(C.jsx("path",{d:"M17 4h3c1.1 0 2 .9 2 2v2h-2V6h-3zM4 8V6h3V4H4c-1.1 0-2 .9-2 2v2zm16 8v2h-3v2h3c1.1 0 2-.9 2-2v-2zM7 18H4v-2H2v2c0 1.1.9 2 2 2h3zM18 8H6v8h12z"})),sn=function(e,t,r){var n=(e+1)%t.length;if(!(!!r&&0===n))return t[(e+1)%t.length]},ln=function(e){var t=e.tooltip,r=e.value,n=e.defaultValue,i=e.values,a=e.setValue,o=e.valueToDisplayData,s=e.isDefaultable,l=e.onDefault,u=e.defaultIcon,c=fe().t,d=void 0===r,p=x.useMemo(function(){return d?-1:i.indexOf(r)},[r,i]);return C.jsx(G,{title:t,children:d?C.jsx(Pe,{onClick:function(){return a(i[0])},sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},variant:"contained",startIcon:u,size:"large",children:void 0===n?c("global.label.default"):C.jsx(nr,{i18nKey:"settings.default_value",value:o[n].isTitleString?o[n].title:c(o[n].title)})}):C.jsx(Pe,{onClick:function(){var e=sn(p,i,s);void 0!==e?a(e):null==l||l()},sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},variant:"contained",startIcon:o[r].icon,size:"large",children:o[r].isTitleString?o[r].title:c(o[r].title)})})},un=function(e){var t=e.pageScaleMode,r=e.shouldStretchPage,n=e.updateSetting,a=d(e,i),o=fe().t;return C.jsxs(A,{sx:{flexDirection:"row",gap:1},children:[C.jsx(ln,g(g({},a),{},{tooltip:o("reader.settings.page_scale.title"),value:t.isDefault?void 0:t.value,defaultValue:t.isDefault?t.value:void 0,values:Ee,setValue:function(e){return n("pageScaleMode",e)},valueToDisplayData:Te,defaultIcon:Te[t.value].icon})),we[t.value]&&C.jsx(G,{title:o("reader.settings.page_scale.stretch"),children:C.jsx(pr,{onClick:function(){return n("shouldStretchPage",!r.value)},sx:{px:void 0},variant:"contained",color:r.value?"secondary":"primary",children:C.jsx(on,{})})})]})},cn=function(e){var t=e.readingMode,r=e.setReadingMode,n=d(e,a),i=fe().t;return C.jsx(ln,g(g({},n),{},{tooltip:i("reader.settings.label.reading_mode"),value:t.isDefault?void 0:t.value,defaultValue:t.isDefault?t.value:void 0,values:De,setValue:r,valueToDisplayData:Ie,defaultIcon:Ie[t.value].icon}))},dn=function(){return C.jsx(Me,{children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:C.jsx("path",{d:"M2 4h6a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2m20 0h-6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M2 12h20m-3-3 3 3-3 3M5 9l-3 3 3 3"})})})},pn=function(e){var t=e.readingMode,r=e.shouldOffsetDoubleSpreads,n=e.setShouldOffsetDoubleSpreads,i=fe().t;return Le(t)?C.jsx(Pe,{sx:{justifyContent:"start",textTransform:"unset"},size:"large",onClick:function(){return n(!r)},color:r?"secondary":"primary",variant:"contained",startIcon:C.jsx(dn,{}),children:i("reader.settings.label.offset_double_spread")}):null},gn=function(e){var t=e.readingDirection,r=e.setReadingDirection,n=d(e,o),i=fe().t;return C.jsx(ln,g(g({},n),{},{tooltip:i("reader.settings.label.reading_direction"),value:t.isDefault?void 0:t.value,defaultValue:t.isDefault?t.value:void 0,values:Re,setValue:r,valueToDisplayData:Oe,defaultIcon:Oe[t.value].icon}))},fn=ge(C.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 14H9V8h2zm4 0h-2V8h2z"})),hn=ge(C.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 14.5v-9l6 4.5z"})),vn=function(e){var t=e.autoScroll,r=e.setAutoScroll,n=fe().t,i=ke(),a=i.isActive,o=i.toggleActive,s=x.useRef(void 0);return C.jsxs(A,{sx:{flexDirection:"row",gap:1},children:[C.jsx(Pe,{sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},size:"large",onClick:o,color:a?"secondary":"primary",variant:"contained",startIcon:a?C.jsx(fn,{}):C.jsx(hn,{}),children:n("reader.settings.auto_scroll.title")}),C.jsx(Ae,{value:t.value,type:"number",size:"small",onBlur:function(e){var n=_e(+e.target.value,Ne.min,Ne.max);n!==t.value&&(clearTimeout(s.current),r(g(g({},t),{},{value:n}),!0))},onChange:function(e){var n=_e(+e.target.value,Ne.min,Ne.max);r(g(g({},t),{},{value:n}),!1),clearTimeout(s.current),s.current=setTimeout(function(){return r(g(g({},t),{},{value:n}),!0)},1e3)},slotProps:{input:{inputProps:Ne,endAdornment:C.jsx(Be,{position:"end",children:n("global.time.seconds.second",{count:t.value})})}}})]})},xn=T(function(e){var t=e.manga,r=e.readingMode,n=e.shouldOffsetDoubleSpreads,i=e.pageScaleMode,a=e.shouldStretchPage,o=e.readingDirection,s=e.autoScroll,l=e.openSettings,u=fe().t,c=S.useCreateUpdateSetting(null!=t?t:We),d=S.useCreateDeleteSetting(null!=t?t:We);return C.jsxs(A,{sx:{gap:1},children:[C.jsx(cn,{readingMode:r,setReadingMode:function(e){return c("readingMode",e)},isDefaultable:!0,onDefault:function(){return d("readingMode")}}),C.jsx(pn,{readingMode:r.value,shouldOffsetDoubleSpreads:n.value,setShouldOffsetDoubleSpreads:function(e){return c("shouldOffsetDoubleSpreads",e)}}),C.jsx(un,{pageScaleMode:i,shouldStretchPage:a,updateSetting:c,isDefaultable:!0,onDefault:function(){return d("pageScaleMode")}}),C.jsx(gn,{readingDirection:o,setReadingDirection:function(e){return c("readingDirection",e)},isDefaultable:!0,onDefault:function(){return d("readingDirection")}}),C.jsx(vn,{autoScroll:s,setAutoScroll:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return c.apply(void 0,["autoScroll"].concat(t))}}),C.jsx(Pe,{onClick:function(){return l()},size:"large",sx:{justifyContent:"start",textTransform:"none"},variant:"contained",startIcon:C.jsx(ze,{}),children:u("settings.title")})]})},[b,S.useSettings],["manga","readingMode","shouldOffsetDoubleSpreads","pageScaleMode","shouldStretchPage","readingDirection","autoScroll"]),mn=ge(C.jsx("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"})),bn=g(g({},We),{},{title:"Fallback",inLibrary:!1}),Sn=T(x.memo(function(e){var t=e.manga,r=(null!=t?t:bn).inLibrary,n=fe().t,i=gr(null!=t?t:bn,!0),a=i.CategorySelectComponent,o=i.updateLibraryState;return C.jsxs(C.Fragment,{children:[C.jsx(G,{title:n(r?"manga.action.library.remove.label.action":"manga.button.add_to_library"),children:C.jsx(Ve,{onClick:o,color:"inherit",children:r?C.jsx(Tr,{}):C.jsx(fr,{})})}),a]})}),[b],["manga"]),Cn=ge(C.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"})),yn=x.memo(function(e){var t=e.id,r=e.isBookmarked,n=fe().t,i=r?"unbookmark":"bookmark";return C.jsx(G,{title:n(Fe[i].action.single),children:C.jsx(Ve,{onClick:function(){return He.performAction(i,[t],{})},color:"inherit",children:r?C.jsx(Sr,{}):C.jsx(Cn,{})})})}),jn=function(e){var t,r=e.currentChapter,n=fe().t,i=He.useDownloadStatusFromCache(null!==(t=null==r?void 0:r.id)&&void 0!==t?t:-1);return r&&He.isDownloaded(r)?C.jsx(G,{title:n(Fe.delete.action.single),children:C.jsx(Ve,{onClick:function(){return He.performAction("delete",[r.id],{})},color:"inherit",children:C.jsx(Pr,{})})}):i?C.jsx(wr,{chapterId:i.chapter.id}):C.jsx(G,{title:n(Fe.download.action.single),disabled:!r,children:C.jsx(Ve,{disabled:!r,onClick:function(){var e;return He.performAction("download",[null!==(e=null==r?void 0:r.id)&&void 0!==e?e:-1],{})},color:"inherit",children:C.jsx(jr,{})})})},Pn=x.memo(function(e){var t=e.currentChapter,r=e.pageLoadStates,n=e.setPageLoadStates,i=e.setRetryFailedPagesKeyPrefix,a=null!=t?t:Ge,o=a.id,s=a.isBookmarked,l=a.realUrl,u=fe().t,c=x.useRef(0),d=x.useMemo(function(){return r.some(function(e){return e.error})},[r]);return C.jsxs(A,{sx:{flexDirection:"row",justifyContent:"center",gap:1},children:[C.jsx(Sn,{}),C.jsx(yn,{id:o,isBookmarked:s}),C.jsx(G,{title:u("reader.button.retry_load_pages"),disabled:!d,children:C.jsx(Ve,{onClick:function(){n(function(e){return e.map(function(e){return{url:e.url,loaded:e.loaded}})}),i("".concat(c.current)),c.current=(c.current+1)%1e3},disabled:!d,color:"inherit",children:C.jsx(mn,{})})}),C.jsx(jn,{currentChapter:t}),C.jsx(G,{title:u("global.button.open_browser"),disabled:!l,children:C.jsx(Ve,{disabled:!l,href:null!=l?l:"",rel:"noreferrer",target:"_blank",color:"inherit",children:C.jsx(Cr,{})})}),C.jsx(G,{title:u("global.button.open_webview"),disabled:!l,children:C.jsx(Ve,{disabled:!l,href:l?Xe.getWebviewUrl(l):"",rel:"noreferrer",target:"_blank",color:"inherit",children:C.jsx(yr,{})})})]})}),wn=T(Pn,[Ue,M],["currentChapter","pageLoadStates","setPageLoadStates","setRetryFailedPagesKeyPrefix"]),Tn=T(x.memo(function(e){var t=e.exit,r=fe().t,n=he();return C.jsx(G,{title:r("reader.button.exit"),children:C.jsx(Ve,{sx:{marginRight:2},onClick:t,color:"inherit",children:n(C.jsx(Ye,{}),C.jsx(Ze,{}))})})}),[function(){return{exit:S.useExit()}}],["exit"]),En=T(x.memo(function(e){var t=e.isVisible,r=e.openSettings,n=e.setReaderNavBarWidth,i=e.manga,a=e.chapters,o=e.currentChapter,s=e.previousChapter,l=e.nextChapter,u=e.isStaticNav,c=fe().t,d=S.useCreateUpdateSetting(null!=i?i:We),p=h(x.useState(),2),g=p[0],f=p[1];Z(g,x.useCallback(function(){u&&n(g.offsetWidth)},[g,u])),x.useLayoutEffect(function(){return function(){return n(0)}},[]);var v=function(e,t){var r=x.useRef(t),n=x.useRef(t);return n.current!==r.current&&!e&&(r.current=!1),n.current!==t&&(r.current=n.current,n.current=t),r.current}(t,u),m=v&&t?0:void 0;return C.jsx(qe,{variant:u?"permanent":"persistent",open:t||u,transitionDuration:m,SlideProps:{unmountOnExit:!0},PaperProps:{ref:function(e){return f(e)}},children:C.jsxs(Kr,{sx:{backgroundColor:"background.paper",pointerEvents:"all"},children:[C.jsxs(A,{sx:{p:2,gap:2,backgroundColor:"action.hover"},children:[C.jsxs(A,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[C.jsx(Tn,{}),C.jsx(G,{title:c("reader.settings.label.static_navigation"),children:C.jsx(Ve,{onClick:function(){n(0),d("isStaticNav",!u)},color:u?"primary":"inherit",children:u?C.jsx(lr,{}):C.jsx(ur,{})})})]}),i&&o?C.jsxs(C.Fragment,{children:[C.jsx(Jr,{mangaId:i.id,mangaTitle:i.title,chapterTitle:o.name,scanlator:o.scanlator}),C.jsx(wn,{})]}):C.jsx(Ke,{})]}),C.jsxs(A,{sx:{p:2,gap:2},children:[C.jsxs(A,{sx:{gap:1},children:[C.jsx(tn,{}),C.jsx(an,{chapters:a,currentChapter:o,nextChapter:l,previousChapter:s})]}),C.jsx(Je,{}),C.jsx(xn,{openSettings:r})]})]})})}),[I,b,Ue,M,S.useSettingsWithoutDefaultFlag],["setReaderNavBarWidth","manga","chapters","currentChapter","previousChapter","nextChapter","isStaticNav"]),In=g(g({},We),{},{title:""}),Dn=x.forwardRef(function(e,t){var r,n,i=e.isVisible,a=e.manga,o=e.currentChapter,s=e.scrollbarYSize,u=fe().t,d=Se({popupId:"reader-overlay-more-menu",variant:"popover"}),p=null!=a?a:In,f=p.id,h=p.title,v=null!=o?o:Ge,x=v.id,m=v.name,b=v.realUrl,S=v.isBookmarked;return C.jsx($e,{direction:"down",in:i,ref:t,children:C.jsxs(A,{sx:{flexDirection:"row",alignItems:"center",position:"fixed",top:0,left:0,right:"".concat(s,"px"),p:2,pt:function(e){return"max(env(safe-area-inset-top), ".concat(e.spacing(2),")")},backgroundColor:function(e){return se(e.palette.background.paper,.95)},pointerEvents:"all",boxShadow:2},children:[C.jsx(Tn,{}),C.jsx(A,{sx:{flexGrow:1},children:a&&o?C.jsxs(C.Fragment,{children:[C.jsx(G,{title:h,children:C.jsx(ce,{lines:1,component:"h1",variant:"h5",children:C.jsx(cr,{component:pe,to:de.manga.path(f),sx:{textDecoration:"none",color:"inherit"},children:h})})}),C.jsx(G,{title:m,children:C.jsx(ce,{lines:1,children:m})})]}):C.jsx(Ke,{})}),C.jsx(Sn,{}),C.jsx(yn,{id:x,isBookmarked:S}),C.jsx(Ve,g(g({},Ce(d)),{},{color:"inherit",children:C.jsx(hr,{})})),C.jsxs(Qe,g(g({},et(d)),{},{children:[C.jsx(be,{component:cr,disabled:!b,href:null!=b?b:"",rel:"noreferrer",target:"_blank",children:u("global.button.open_browser")}),C.jsx(be,{component:cr,disabled:!b,href:b?Xe.getWebviewUrl(b):"",rel:"noreferrer",target:"_blank",children:u("global.button.open_webview")}),C.jsx(be,{disabled:!b,onClick:(r=l().m(function e(){return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,navigator.clipboard.writeText(h);case 1:tt(u("global.label.copied_clipboard"),"info");case 2:return e.a(2)}},e)}),n=function(){var e=this,t=arguments;return new Promise(function(n,i){var a=r.apply(e,t);function o(e){c(a,n,i,o,s,"next",e)}function s(e){c(a,n,i,o,s,"throw",e)}o(void 0)})},function(){return n.apply(this,arguments)}),children:u("global.label.share")})]}))]})})}),Mn=T(x.memo(Dn),[b,Ue,E],["manga","currentChapter","scrollbarYSize"]),Ln=ge(C.jsx("path",{d:"m21.81 12.74-.82-.63v-.22l.8-.63c.16-.12.2-.34.1-.51l-.85-1.48c-.07-.13-.21-.2-.35-.2q-.075 0-.15.03l-.95.38c-.08-.05-.11-.07-.19-.11l-.15-1.01c-.03-.21-.2-.36-.4-.36h-1.71c-.2 0-.37.15-.4.34l-.14 1.01c-.03.02-.07.03-.1.05l-.09.06-.95-.38q-.075-.03-.15-.03c-.14 0-.27.07-.35.2l-.85 1.48c-.1.17-.06.39.1.51l.8.63v.23l-.8.63c-.16.12-.2.34-.1.51l.85 1.48c.07.13.21.2.35.2q.075 0 .15-.03l.95-.37c.08.05.12.07.2.11l.15 1.01c.03.2.2.34.4.34h1.71c.2 0 .37-.15.4-.34l.15-1.01c.03-.02.07-.03.1-.05l.09-.06.95.38q.075.03.15.03c.14 0 .27-.07.35-.2l.85-1.48c.1-.17.06-.39-.1-.51M18 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5M17 17h2v4c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v4h-2V6H7v12h10z"})),On=ge(C.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5m0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5m0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5M7 19h14v-2H7zm0-6h14v-2H7zm0-8v2h14V5z"})),Rn=ge(C.jsx("path",{d:"M6 6h2v12H6zm3.5 6 8.5 6V6z"})),kn=ge(C.jsx("path",{d:"m6 18 8.5-6L6 6zM16 6v12h2V6z"})),An={display:"flex",alignItems:"center",justifyContent:"end",position:"relative",backgroundColor:"background.default"},Nn=x.memo(function(e){var t=e.isTrailingPage,r=e.pagesIndex,n=e.totalPages,i=e.isVertical,a=e.isHorizontal,o="".concat(r/(n-1)*100,"%");return C.jsx(N,{sx:g(g(g(g({position:"absolute"},j(i,{top:o,left:"50%"})),j(a,{top:"50%",left:o})),{},{transform:"translate(-50%, -50%)",width:"3px",height:"3px",borderRadius:100,backgroundColor:"background.paper"},j(t,{backgroundColor:"primary.main"})),{},{zIndex:1})})}),Bn=x.memo(function(e){var t=e.pageName,r=e.isTrailingPage,n=e.isCurrentPage,i=e.pagesIndex,a=e.totalPages,o=e.isVertical,s=e.isHorizontal;return C.jsx(Yr,{pageName:t,progressBarPosition:rt.BOTTOM,slotProps:{box:{sx:An}},children:!n&&C.jsx(Nn,{isTrailingPage:r,pagesIndex:i,totalPages:a,isVertical:o,isHorizontal:s})})}),_n=f(f(f(f({},rt.BOTTOM,"up"),rt.LEFT,"right"),rt.RIGHT,"left"),rt.AUTO,"left"),Wn=T(x.memo(function(e){var t=e.previousChapter,r=e.nextChapter,n=e.isVisible,i=e.setIsMaximized,a=e.isDragging,o=e.currentPageIndex,s=e.pages,l=e.direction,u=e.progressBarPosition,c=e.progressBarPositionAutoVertical,d=e.topOffset,p=void 0===d?0:d,f=e.bottomOffset,v=void 0===f?0:f,m=e.scrollbarXSize,b=Y.useOpenChapter(),S=h(x.useState({}),2)[1];Z(window.document.documentElement,x.useCallback(function(){return S({})},[]));var y=ue(u,c,p+v,m),P=U(y),w=P.isLeft,T=P.isRight,E=P.isVertical,I=P.isHorizontal,D=I?l:"ltr",M=x.useMemo(function(){return L(o,s).pagesIndex},[o,s]),O=x.useMemo(function(){return{container:{sx:{flexGrow:1,position:"relative",display:"flex",justifyItems:"center",alignItems:"stretch",backgroundColor:function(e){return se(e.palette.background.paper,.85)},borderRadius:100,boxShadow:2}},progressBarRoot:{sx:g(g({flexGrow:1,gap:0},j(E,{flexDirection:"column"})),j(I,{alignItems:"stretch"}))},progressBarSlotsActionArea:{sx:g(g({alignItems:"center",cursor:"pointer"},j(E,{width:"100%",flexDirection:"column",px:2})),j(I,{height:"100%",py:2}))},progressBarSlotsContainer:{sx:g(g({borderRadius:100,backgroundColor:"background.default"},j(E,{flexDirection:"column",py:1})),j(I,{px:1}))},progressBarSlot:{sx:g(g({},j(E,{width:"20px"})),j(I,{height:"20px"}))},progressBarCurrentPageSlot:{sx:g(g({display:"flex",zIndex:1,cursor:"inherit"},j(E,{justifyContent:"center"})),j(I,{alignItems:"center"}))},progressBarPageTexts:{base:{sx:g(g({},j(E,{py:1})),j(I,{px:1}))}}}},[E,I]),R=x.useMemo(function(){return{progressBarCurrentPage:C.jsx(N,{sx:g(g(g({position:"absolute"},j(E,g(g({top:"calc(100% - 6px)"},j(0===M,{top:"0"})),{},{width:"75%",height:"6px"}))),j(I,g(g({left:"calc(100% - 0px)"},j(0===M,{left:"0"})),{},{width:"6px",height:"75%"}))),{},{backgroundColor:"primary.main",borderRadius:100,cursor:a?"grabbing":"grab"})})}},[M,s.length,a,E,I]);return x.useLayoutEffect(function(){return i(n),function(){return i(!1)}},[n]),C.jsx($e,{direction:_n[y],in:n,children:C.jsx(Xr,{sx:g(g({position:"relative",display:"flex",alignItems:"end",height:"100%",pointerEvents:"none"},j(w,{justifyContent:"ltr"===l?"start":"end"})),j(T,{justifyContent:"ltr"===l?"end":"start"})),children:C.jsxs(A,{sx:g(g({p:2,gap:1,pointerEvents:"all",alignItems:"center"},j(E,{height:"100%",flexDirection:"column"})),j(I,{width:"100%",flexDirection:"row"})),children:[C.jsx(Ve,{onClick:function(){return b("previous")},disabled:!t,sx:{backgroundColor:function(e){return se(e.palette.background.paper,.85)},boxShadow:2},children:K(C.jsx(Rn,{sx:g({},j(E,{transform:"rotate(90deg)"}))}),C.jsx(kn,{sx:g({},j(E,{transform:"rotate(90deg)"}))}),D)}),C.jsx(Ur,{direction:D,progressBarPosition:y,fullSegmentClicks:!1,createProgressBarSlot:x.useCallback(function(e,t,r,n,i,a,o,s){return C.jsx(Bn,{pageName:e.name,isTrailingPage:o,isCurrentPage:i,pagesIndex:t,totalPages:s,isVertical:E,isHorizontal:I})},[E,I]),slotProps:g(g({},O),{},{progressBarReadPages:{sx:g(g({backgroundColor:"primary.main"},j(E,{width:"20px",height:"".concat(Math.max(0,L(o,s).pagesIndex)/(s.length-1)*100,"%"),borderRadius:"400px 400px 0 0"})),j(I,{width:"".concat(Math.max(0,L(o,s).pagesIndex)/(s.length-1)*100,"%"),height:"20px",borderRadius:"400px 0 0 400px"}))}}),slots:R}),C.jsx(Ve,{onClick:function(){return b("next")},disabled:!r,sx:{backgroundColor:function(e){return se(e.palette.background.paper,.85)},boxShadow:2},children:K(C.jsx(kn,{sx:g({},j(E,{transform:"rotate(90deg)"}))}),C.jsx(Rn,{sx:g({},j(E,{transform:"rotate(90deg)"}))}),D)})]})})})}),[Ue,nt,D,M,function(){return{direction:S.useGetThemeDirection()}},S.useSettingsWithoutDefaultFlag,E],["previousChapter","nextChapter","isVisible","setIsMaximized","isDragging","currentPageIndex","pages","direction","progressBarPosition","progressBarPositionAutoVertical","scrollbarXSize"]),zn=T(x.memo(function(e){var t=e.manga,r=e.readingMode,n=e.readingDirection,i=e.autoScroll,a=e.isActive,o=e.toggleActive,s=fe().t,l=S.useCreateDeleteSetting(null!=t?t:We);return t?C.jsxs(A,{sx:{gap:2},children:[C.jsx(ir,{}),C.jsx(ar,{readingMode:r,setReadingMode:function(e){return S.updateSetting(t,"readingMode",e)},isDefaultable:!0,onDefault:function(){return l("readingMode")}}),C.jsx(or,{readingDirection:n,setReadingDirection:function(e){return S.updateSetting(t,"readingDirection",e)},isDefaultable:!0,onDefault:function(){return l("readingDirection")}}),C.jsx(Er,{label:s("reader.settings.auto_scroll.title"),checked:a,onChange:function(){return o()}}),C.jsx(sr,{autoScroll:i,setAutoScroll:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=S).updateSetting.apply(e,[t,"autoScroll"].concat(n))}})]}):null}),[b,S.useSettings,ke],["manga","readingMode","readingDirection","autoScroll","isActive","toggleActive"]),Vn=T(x.memo(function(e){var t=e.openSettings,r=e.isVisible,n=e.currentChapter,i=e.chapters,a=e.scrollbarXSize,o=e.scrollbarYSize,s=e.topOffset,l=void 0===s?0:s,u=fe().t,c=Se({variant:"dialog",popupId:"reader-chapter-list-dialog"}),d=Se({variant:"dialog",popupId:"reader-quick-settings-dialog"}),p=h(x.useState(0),2),f=p[0],v=p[1],m=x.useRef(null);return Z(m,x.useCallback(function(){var e,t;return v(null!==(e=null===(t=m.current)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:0)},[f])),x.useLayoutEffect(function(){c.close()},[null==n?void 0:n.id]),C.jsxs(C.Fragment,{children:[C.jsxs(A,{sx:{position:"fixed",right:"".concat(o,"px"),bottom:0,left:0,height:"calc(100% - ".concat(l,"px)")},children:[C.jsx(Wn,{topOffset:l,bottomOffset:f}),C.jsx($e,{direction:"up",in:r,children:C.jsx(A,{ref:m,sx:{alignItems:"center",backgroundColor:function(e){return se(e.palette.background.paper,.95)},pb:"max(".concat(a,"px, env(safe-area-inset-bottom))"),boxShadow:2,pointerEvents:"all"},children:C.jsxs(A,{sx:{width:"50%",flexDirection:"row",p:2,gap:1,justifyContent:"space-evenly",alignItems:"center"},children:[C.jsx(G,{title:u("reader.button.chapter_list"),children:C.jsx(Ve,g(g({},Ce(c)),{},{color:"inherit",children:C.jsx(On,{})}))}),C.jsx(G,{title:u("reader.settings.title.quick_settings"),children:C.jsx(Ve,g(g({},Ce(d)),{},{color:"inherit",children:C.jsx(Ln,{})}))}),C.jsx(G,{title:u("settings.title"),children:C.jsx(Ve,{onClick:t,color:"inherit",children:C.jsx(ze,{})})})]})})})]}),c.isOpen&&C.jsx(y,g(g({},it(c)),{},{fullWidth:!0,maxWidth:"md",scroll:"paper",children:C.jsx(P,{sx:{p:0,pb:1},children:C.jsx(nn,{style:{minHeight:"15vh",maxHeight:"75vh"},currentChapter:n,chapters:i})})})),d.isOpen&&C.jsx(y,g(g({},it(d)),{},{fullWidth:!0,maxWidth:"md",scroll:"paper",children:C.jsx(P,{children:C.jsx(zn,{})})}))]})}),[Ue,E],["currentChapter","chapters","scrollbarXSize","scrollbarYSize"]),Hn=T(x.memo(function(e){var t=e.isVisible,r=e.isDesktop,n=e.isMobile,i=h(x.useState(!1),2),a=i[0],o=i[1],s=h(x.useState(0),2),l=s[0],c=s[1],d=x.useRef(null);return Z(d,x.useCallback(function(){var e,t;return c(null!==(e=null===(t=d.current)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:0)},[n])),C.jsxs(N,{sx:{position:"absolute",width:"100%",height:"100%",pointerEvents:"none",zIndex:1},children:[r&&C.jsxs(C.Fragment,{children:[C.jsx(qr,{}),C.jsx(En,{isVisible:t,openSettings:function(){return o(!0)}})]}),n&&C.jsxs(C.Fragment,{children:[C.jsx(Mn,{ref:d,isVisible:t}),C.jsx(Vn,{openSettings:function(){return o(!0)},isVisible:t,topOffset:l})]}),C.jsx(u,{isOpen:a,close:function(){return o(!1)}}),C.jsx(Or,{})]})}),[S.useOverlayMode],["isDesktop","isMobile"]),Fn="reader-tap-zone-layout-canvas",Un=T(function(e){var t=e.readerNavBarWidth,r=e.showPreview,n=e.tapZoneLayout,i=e.tapZoneInvertMode,a=e.readingDirection,o=ae(),s=h(x.useState(0),2),l=s[0],u=s[1],c=h(x.useState(0),2),d=c[0],p=c[1],g=h(x.useState(null),2),f=g[0],v=g[1];Z(f,x.useCallback(function(){var e,t;u(null!==(e=null==f?void 0:f.clientWidth)&&void 0!==e?e:0),p(null!==(t=null==f?void 0:f.clientHeight)&&void 0!==t?t:0)},[f]));var m=ot.getOrCreateCanvas(n,l,d,o.typography.h3,{vertical:i.vertical,horizontal:i.horizontal,isRTL:a===R.RTL});return x.useLayoutEffect(function(){var e=document.getElementById(Fn);null==e||e.replaceChildren(m)},[m,r]),C.jsx(N,{ref:v,sx:{position:"fixed",top:0,left:t,right:0,bottom:0,pointerEvents:"none"},children:r&&C.jsx("div",{id:Fn})})},[I,at,S.useSettingsWithoutDefaultFlag],["readerNavBarWidth","showPreview","tapZoneLayout","tapZoneInvertMode","readingDirection"]),Gn=T(function(e){var t=e.readerNavBarWidth,r=e.customFilter.rgba,n=r.value,i=n.red,a=n.green,o=n.blue,s=n.alpha,l=n.blendMode;return r.enabled?C.jsx(N,{sx:{position:"fixed",top:0,left:t,right:0,bottom:0,pointerEvents:"none",background:"rgba(".concat(i," ").concat(a," ").concat(o," / ").concat(s,"%)"),mixBlendMode:"".concat(l)}}):null},[I,S.useSettingsWithoutDefaultFlag],["readerNavBarWidth","customFilter"]),Xn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:st.XY,r=h(x.useState(!1),2),n=r[0],i=r[1],a=x.useRef(void 0),o=x.useRef([0,0,0]),s=x.useRef([0,0,0]),l=x.useRef([0,0,0]),u=x.useRef([0,0]),c=x.useRef(void 0),d=x.useRef([0,0]),p=x.useRef([0,0]);return x.useEffect(function(){var r=null==e?void 0:e.current;if(!r)return function(){};var n=function(){a.current||(a.current=getComputedStyle(r));var e="rtl"===a.current.direction,t="row-reverse"===a.current.flexDirection;return e||!e&&t},g=t!==st.Y,f=t!==st.X,h=function(){void 0!==c.current&&(cancelAnimationFrame(c.current),c.current=void 0)},x=!1,m=function(e){(function(e){if(x)return!0;var t=[r.clientHeight<r.scrollHeight,r.clientWidth<r.scrollWidth],n=[Math.abs(o.current[0]-e.pageX)>0,Math.abs(s.current[0]-e.pageY)>0];return t[0]&&n[0]||t[1]&&n[1]})(e)&&(x=!0,i(!0),o.current=[].concat(v(o.current.slice(1)),[e.pageX]),s.current=[].concat(v(s.current.slice(1)),[e.pageY]),l.current=[].concat(v(l.current.slice(1)),[Date.now()]),g&&(r.scrollLeft=p.current[0]-(e.pageX-d.current[0])),f&&(r.scrollTop=p.current[1]-(e.pageY-d.current[1])))},b=function(){r.removeEventListener("mousemove",m),r.removeEventListener("mouseup",b),setTimeout(function(){x=!1,i(!1)},0),u.current=[r.scrollLeft,r.scrollTop];var e=function(){!function(){var e=function(e,t,r){return(e[0]-e[2])/(t[0]-t[2])*1e3/r},t=[g?e(o.current,l.current,r.clientWidth):0,f?e(s.current,l.current,r.clientHeight):0],i=g&&f?Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)):f?Math.abs(t[1]):Math.abs(t[0]),c=[t[0]/i,t[1]/i],d=_e(1.2*i,-12,12),p=(Date.now()-l.current[0])/1e3,v=d-14.278*p+75.24*Math.pow(p,2)/d-149.72*Math.pow(p,3)/d/d;if(0!==d&&v>0&&!Number.isNaN(d)){var x=function(e,t){return e*t*(d*p-7.1397*Math.pow(p,2)+25.08*Math.pow(p,3)/d-37.43*Math.pow(p,4)/d/d)},m=[x(r.clientWidth,c[0]),x(r.clientHeight,c[1])],b=[r.scrollWidth-r.clientWidth,r.scrollHeight-r.clientHeight],S=[_e(u.current[0]-m[0],n()?-b[0]:0,b[0]),_e(u.current[1]-m[1],(a.current||(a.current=getComputedStyle(r)),"column-reverse"===a.current.flexDirection?-b[1]:0),b[1])];0!==S[0]||S[0]!==b[0]||0!==S[1]||S[1]!==b[1]||h(),g&&(r.scrollLeft=S[0]),f&&(r.scrollTop=S[1])}else h()}(),c.current=requestAnimationFrame(e)};c.current=requestAnimationFrame(e)},S=function(e){0===e.button&&(e.preventDefault(),d.current=[e.pageX,e.pageY],p.current=[r.scrollLeft,r.scrollTop],o.current=[e.pageX,e.pageX,e.pageX],s.current=[e.pageY,e.pageY,e.pageY],l.current=[Date.now()-2,Date.now()-1,Date.now()],r.addEventListener("mousemove",m),r.addEventListener("mouseup",b),h())};return r.addEventListener("mousedown",S),r.addEventListener("wheel",h),function(){r.removeEventListener("mousedown",S),r.removeEventListener("wheel",h),h()}},[e,t]),n},Yn=function(e){var t=e.title,r=e.name,n=e.scanlator,i=e.backgroundColor,a=ae(),o=a.palette.getContrastText(mt(a.palette,bt[i])),s=se(o,.5);return r?C.jsxs(A,{children:[C.jsx(B,{color:o,children:t}),C.jsx(B,{color:o,variant:"h6",component:"h1",children:r}),n&&C.jsx(B,{variant:"body2",color:s,children:n})]}):null},Zn=T(x.memo(function(e){var t,r=e.type,n=e.transitionPageMode,i=e.readingMode,a=e.backgroundColor,o=e.shouldShowTransitionPage,s=e.manga,l=e.currentChapterName,u=e.currentChapterScanlator,c=e.previousChapterName,d=e.previousChapterScanlator,p=e.nextChapterName,f=e.nextChapterScanlator,h=e.scrollbarXSize,v=e.scrollbarYSize,x=e.readerNavBarWidth,m=e.handleBack,b=fe().t,S=r===gt.PREVIOUS,y=r===gt.NEXT,P=!!l&&!c,w=!!l&&!p,T=P&&r===gt.PREVIOUS,E=w&&r===gt.NEXT;return(o||(T||E))&&ht(r,n,i)?C.jsx(A,{sx:g(g({justifyContent:"center",alignItems:"center"},j(!xt(i),{width:"100%",height:"100%"})),j(xt(i),g(g({position:"sticky"},j(vt(i),{left:0,maxWidth:"calc(100vw - ".concat(v,"px - ").concat(x,"px)"),minHeight:"calc(100vh - ".concat(h,"px)")})),j(i===q.CONTINUOUS_HORIZONTAL,{top:0,minWidth:"calc(100vw - ".concat(v,"px - ").concat(x,"px)"),maxHeight:"calc(100vh - ".concat(h,"px)")})))),children:C.jsxs(A,{sx:{gap:2,maxWidth:function(e){return"calc(100vw - ".concat(v,"px - ").concat(x,"px - ").concat(e.spacing(2),")")},maxHeight:"calc(100vh - ".concat(h,"px)"),width:"max-content",p:1},children:[S&&P&&C.jsx(B,{variant:"h6",children:b("reader.transition_page.first_chapter")}),C.jsxs(A,{sx:{gap:5},children:[S&&!P&&C.jsx(Yn,{title:b("reader.transition_page.previous"),name:c,scanlator:d,backgroundColor:a}),!!l&&C.jsx(Yn,{title:b(S?"reader.transition_page.current":"reader.transition_page.finished"),name:l,scanlator:u,backgroundColor:a}),y&&!w&&C.jsx(Yn,{title:b("reader.transition_page.next"),name:p,scanlator:f,backgroundColor:a})]}),y&&w&&C.jsx(B,{variant:"h6",children:b("reader.transition_page.last_chapter")}),(S&&P||y&&w)&&C.jsxs(A,{sx:{flexDirection:"row",flexWrap:"wrap",gap:1},children:[C.jsx(Pe,{sx:{flexGrow:1},onClick:function(e){e.stopPropagation(),m()},variant:"contained",children:b("reader.transition_page.exit.previous_page")}),C.jsx(Pe,{sx:{flexGrow:1},component:pe,onClick:function(e){e.stopPropagation()},variant:"contained",to:de.manga.path(null!==(t=null==s?void 0:s.id)&&void 0!==t?t:-1),children:b("reader.transition_page.exit.manga_page")})]})]})}):null}),[b,function(e){var t=e.chapterId,r=Ue().chapters,n=x.useMemo(function(){return r.findIndex(function(e){return e.id===t})},[t,r]),i=r[n],a=x.useMemo(function(){return r[n+1]},[n,r]),o=x.useMemo(function(){return r[n-1]},[n,r]);return{currentChapterName:null==i?void 0:i.name,currentChapterScanlator:null==i?void 0:i.scanlator,previousChapterName:null==a?void 0:a.name,previousChapterScanlator:null==a?void 0:a.name,nextChapterName:null==o?void 0:o.name,nextChapterScanlator:null==o?void 0:o.scanlator}},E,I,M,S.useSettingsWithoutDefaultFlag,function(e){var t=e.chapterId,r=e.type,n=pt(),i=Ue().chapters,a=x.useMemo(function(){return i.findIndex(function(e){return e.id===t})},[t,i]),o=0===a,s=a===i.length-1,l=r===gt.PREVIOUS&&s,u=r===gt.NEXT&&o;return{handleBack:l||u?n:ft}}],["manga","currentChapterName","currentChapterScanlator","previousChapterName","previousChapterScanlator","nextChapterName","nextChapterScanlator","scrollbarXSize","scrollbarYSize","readerNavBarWidth","backgroundColor","transitionPageMode","readingMode","handleBack","shouldShowTransitionPage"]),qn="-10px",Kn=function(e,t,r){if(xt(t)){var n=ve[r],i="0px ".concat(qn," 0px 0px"),a="0px 0px 0px ".concat(qn);return vt(t)?"first"===e?"0px 0px ".concat(qn," 0px"):"".concat(qn," 0px 0px 0px"):"first"===e?K(i,a,n):K(a,i,n)}},Jn=function(e,t,r,n){var i=t.top,a=t.right,o=t.bottom,s=t.left,l=window.innerWidth-n,u=window.innerHeight-r;return f(f({},q.CONTINUOUS_VERTICAL,{start:o>=u,end:i<0}),q.CONTINUOUS_HORIZONTAL,function(e,t,r,n){return e===R.LTR?{start:r>=n,end:t<0}:{start:t<0,end:r>=n}}(e,s,a,l))},$n=function(e,t,r,n,i,a,o,s,l,u,c,d,p,g){x.useEffect(function(){var t=xt(a),o=vt(a);if(g||!p||!t||!s||!n||i||void 0===r)return function(){};var u=function(){var t=0===p.scrollLeft,n=p.scrollLeft===p.scrollWidth-p.clientWidth,i=0===p.scrollTop,a=p.scrollTop===p.scrollHeight-p.clientHeight;("first"===e&&(o?i:t)||"last"===e&&(o?a:n))&&l(r,void 0,!1)};return p.addEventListener("scroll",u),function(){return p.removeEventListener("scroll",u)}},[a,p,g,s,n,i,r,l]),Ct(u,x.useCallback(function(u){if(s&&xt(a)&&void 0!==r&&(g||i)){var p=u[u.length-1],f=Jn(o,p.target.getBoundingClientRect(),c,d),h=function(e,t){var r=e[q.CONTINUOUS_VERTICAL],n=e[q.CONTINUOUS_HORIZONTAL];return vt(t)?r:n}(f,a),v=h.start,x=h.end,m=p.intersectionRatio<=0;if(function(e,t){var r=e[q.CONTINUOUS_VERTICAL],n=e[q.CONTINUOUS_HORIZONTAL];return vt(t)?r.start||r.end:n.start||n.end}(f,a)){var b="last"===e&&!n&&x;"first"===e&&v&&!i||"last"===e&&x&&m?l(r,!i,!1):b&&l(t,!1,!1)}}},[e,t,r,n,i,a,o,s,g,l,c,d]),x.useMemo(function(){return{root:p,threshold:[0],rootMargin:Kn(e,a,o),ignoreInitialObserve:!0}},[e,a,o]))},Qn=T(x.memo(function(e){var t=e.readingMode,r=e.readingDirection,n=e.shouldUseInfiniteScroll,i=e.chapterId,a=e.previousChapterId,o=e.nextChapterId,s=e.isPreviousChapterVisible,l=e.isCurrentChapter,u=e.isNextChapterVisible,c=e.imageWrapper,d=e.openChapter,p=e.scrollbarXSize,g=e.scrollbarYSize,f=e.scrollElement,h=e.shouldShowTransitionPage;return $n("first",i,a,l,s,t,r,n,d,c,p,g,f,h),$n("last",i,o,l,u,t,r,n,d,c,p,g,f,h),null}),[function(){return{openChapter:Y.useOpenChapter()}},S.useSettingsWithoutDefaultFlag],["openChapter","shouldShowTransitionPage"]),ei=x.memo(function(e){var t=e.currentPageIndex,r=e.setPages,n=e.setPageLoadStates,i=e.setTotalPages,a=e.setCurrentPageIndex,o=e.updateCurrentPageIndex,s=e.setPageToScrollToIndex,l=e.transitionPageMode,u=e.retryFailedPagesKeyPrefix,c=e.setTransitionPageMode,d=e.readingMode,p=e.readerWidth,f=e.pageScaleMode,v=e.shouldOffsetDoubleSpreads,m=e.readingDirection,b=e.shouldUseInfiniteScroll,S=e.imagePreLoadAmount,y=e.pageGap,P=e.chapterId,w=e.previousChapterId,T=e.nextChapterId,E=e.isPreviousChapterVisible,I=e.isNextChapterVisible,D=e.lastPageRead,M=e.isInitialChapter,O=e.isCurrentChapter,k=e.isPreviousChapter,B=e.isNextChapter,_=e.isLeadingChapter,W=e.isTrailingChapter,z=e.isPreloadMode,V=e.imageRefs,H=e.scrollIntoView,F=e.setReaderStateChapters,U=e.resumeMode,G=e.customFilter,X=e.shouldStretchPage,Y=e.scrollbarXSize,K=e.scrollbarYSize,$=e.readerNavBarWidth,Q=e.onSizeChange,ee=e.minWidth,te=e.minHeight,re=e.scrollElement,ne=fe().t,ie=ae().direction,oe=h(Xe.useGetChapterPagesFetch(null!=P?P:-1),2),se=oe[0],le=oe[1],ue=h(x.useState(!1),2),ce=ue[0],de=ue[1],pe=h(x.useState(yt.totalPages),2),ge=pe[0],he=pe[1],ve=h(x.useState(yt.pageUrls),2),xe=ve[0],me=ve[1],be=h(x.useState(yt.pages),2),Se=be[0],Ce=be[1],ye=h(x.useState(yt.pageLoadStates),2),je=ye[0],Pe=ye[1],we=h(x.useState(je.map(function(e){return{url:e.url,isSpread:!1}})),2),Te=we[0],Ee=we[1],Ie=x.useRef(null),De=x.useRef(O),Me=x.useRef(Se.map(function(){return null})),Le=x.useRef(null),Oe=x.useMemo(function(){return!ge?Se:ge===Te.length&&d===q.DOUBLE_PAGE?jt(xe,Te,v,m):Se},[Te,d,v,m,ge]),Re=x.useMemo(function(){return Pt(d)},[d]),ke=m===R.LTR,Ae=xt(d),Ne=!Ae&&!O||z,Be=!Ae&&O,_e=!Ne&&(Be||Ae&&(M||_)),We=!Ne&&(Be||Ae&&(M||W));De.current=O,O&&(V.current=Me.current);var ze=x.useCallback(function(){P&&(de(!1),se({variables:{input:{chapterId:P}}}).catch(wt()))},[se,P]),Ve=x.useMemo(function(){return Tt(Oe,Ee,function(e){De.current&&n(e),Pe(e)},d)},[Oe,d]),He=x.useMemo(function(){return Et(function(e){De.current&&n(e),Pe(e)})},[]);x.useEffect(function(){ze()},[P]),Z(Ie,x.useCallback(function(e){var t=e[0].target,r=t.clientWidth,n=t.clientHeight;Q(r,n,P)},[Q,Ie.current,P]));var Fe=function(e,t,r){!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&ce||t(e),O&&r(e)};return function(e,t,r,n,i,a,o,s,l,u,c,d,p,f,h,v,m,b){var S,C=x.useRef(void 0);x.useLayoutEffect(function(){var e,x=null===(e=t.data)||void 0===e?void 0:e.fetchChapterPages;if(x){var S=x.pages,y=S.length?S:[""],j=St(r,null!=n?n:0,y.length-1),P=C.current!==(null==x?void 0:x.pages);if(P){C.current=x.pages;var w=dt(y);l(!0),d(w),p(y),f(w.map(function(e){return{url:e.primary.url,loaded:!1}})),h(w.map(function(e){return{url:e.primary.url,isSpread:!1}}))}else d(i),f(a),h(o);c(x.pages.length),p(y),v(j),m(j),u(function(e){return g(g({},e),{},{isCurrentChapterReady:s||P})}),b(gt.NONE)}},[null===(S=t.data)||void 0===S||null===(S=S.fetchChapterPages)||void 0===S?void 0:S.pages,e])}(O,le,U,D,Oe,je,Te,ce,de,function(e){return Fe(e,ft,F)},function(e){return Fe(e,he,i)},function(e){return Fe(e,Ce,r)},function(e){return Fe(e,me,ft)},function(e){return Fe(e,Pe,n)},function(e){return Fe(e,Ee,ft)},function(e){return Fe(e,ft,a)},function(e){(M&&!ce||H)&&(s(e),F(function(e){return g(g({},e),{},{visibleChapters:g(g({},e.visibleChapters),{},{scrollIntoView:!1,resumeMode:void 0})})}))},function(e){return Fe(e,ft,c)}),function(e,t,r,n,i,a,o){var s=h(x.useState(o===q.DOUBLE_PAGE),2),l=s[0],u=s[1];x.useLayoutEffect(function(){if(l&&o!==q.DOUBLE_PAGE){u(!1);var s=dt(r);return n(s),void i(s.map(function(e){return{url:e.primary.url,isSpread:!1}}))}o===q.DOUBLE_PAGE&&(l||a(J(L(e,t))),n(t),u(o===q.DOUBLE_PAGE))},[t,o])}(t,Oe,xe,function(e){return Fe(e,Ce,r,!0)},function(e){return Fe(e,Ee,ft,!0)},function(e){return Fe(e,ft,o)},d),Ae||O||k||B?le.error?Ne?null:C.jsx(N,{sx:{minHeight:"100%",minWidth:"100%",display:"grid",placeItems:"center",position:"relative"},children:C.jsx(Ir,{message:ne("global.error.label.failed_to_load_data"),messageExtra:It(le.error),retry:function(){ze()}})}):le.loading||!ce?Ne?null:C.jsx(N,{sx:{minHeight:"100%",minWidth:"100%",display:"grid",placeItems:"center"},children:C.jsx(Ke,{})}):null==P||ge?C.jsxs(A,{ref:Ie,sx:g(g(g(g(g({width:"fit-content",height:"fit-content",margin:"auto",flexWrap:"nowrap"},j(d===q.CONTINUOUS_HORIZONTAL,{minHeight:te})),j(vt(d),{minWidth:ee})),j(Ne,{maxWidth:0,maxHeight:0,minWidth:"unset",minHeight:"unset",overflow:"hidden",margin:"unset"})),j(vt(d)&&Dt(p,f),{alignItems:"center"})),j(d===q.CONTINUOUS_HORIZONTAL,g(g({},j("ltr"===ie,{flexDirection:ke?"row":"row-reverse"})),j("rtl"===ie,{flexDirection:ke?"row-reverse":"row"})))),children:[!z&&C.jsx(Qn,{readingMode:d,readingDirection:m,shouldUseInfiniteScroll:b,chapterId:P,previousChapterId:w,nextChapterId:T,isCurrentChapter:O,isPreviousChapterVisible:E,isNextChapterVisible:I,imageWrapper:Le.current,scrollbarXSize:Y,scrollbarYSize:K,scrollElement:re}),_e&&C.jsx(Zn,{chapterId:P,type:gt.PREVIOUS}),C.jsx(Re,{ref:Le,totalPages:ge,currentPageIndex:t,pages:Oe,transitionPageMode:l,pageLoadStates:je,retryFailedPagesKeyPrefix:u,imageRefs:Me,onLoad:Ve,onError:He,isCurrentChapter:O,isPreviousChapter:k,isNextChapter:B,readingMode:d,imagePreLoadAmount:S,readingDirection:m,pageScaleMode:f,pageGap:y,customFilter:G,shouldStretchPage:X,readerWidth:p,scrollbarXSize:Y,scrollbarYSize:K,readerNavBarWidth:$,isPreloadMode:z,resumeMode:U,handleAsInitialRender:H}),We&&C.jsx(Zn,{chapterId:P,type:gt.NEXT})]}):Ne?null:C.jsx(N,{sx:{minWidth:"100%",minHeight:"100%",position:"relative"},children:C.jsx(Ir,{message:ne("reader.error.label.no_pages_found"),retry:ze})}):null}),ti=function(e,t,r){x.useLayoutEffect(function(){r(t)},[e])},ri=function(e,t,r,n){var i=x.useRef({width:window.innerWidth,height:window.innerHeight}),a=x.useCallback(function(){var a=i.current,o=a.width,s=a.height;i.current={width:window.innerWidth,height:window.innerHeight},function(e,t,r,n){var i=Lt(t),a=Ot(t),o=r!==window.innerWidth,s=n!==window.innerHeight,l=i&&o,u=a&&s;return!(vt(e)||!o)||l||u}(e,t,o,s)&&r(n)},[e,t,n]);Dr("resize",a)},ni=function(e){var t=x.useRef({left:0,top:0,visibleElement:void 0,visibleElementLeft:0,visibleElementTop:0});return x.useEffect(function(){var r=e.current;if(!r)return function(){};var n=function(){var e,n,i=t.current.visibleElement;t.current=g(g({},t.current),{},{left:r.scrollLeft,top:r.scrollTop,visibleElementLeft:null!==(e=null==i?void 0:i.offsetLeft)&&void 0!==e?e:0,visibleElementTop:null!==(n=null==i?void 0:i.offsetTop)&&void 0!==n?n:0})};return r.addEventListener("scroll",n),function(){return r.removeEventListener("scroll",n)}},[]),x.useEffect(function(){var r=e.current;if(!r)return function(){};var n=function(e,t){return Array.from(e).filter(function(e){return e instanceof HTMLElement}).flatMap(function(e){return e instanceof HTMLImageElement?[e]:Array.from(e.querySelectorAll("img"))}).forEach(t)},i=new IntersectionObserver(function(e){var r=e.find(function(e){return e.isIntersecting});(null==r?void 0:r.target)instanceof HTMLElement&&(t.current=g(g({},t.current),{},{visibleElement:r.target,visibleElementLeft:r.target.offsetLeft,visibleElementTop:r.target.offsetTop}))}),a=new MutationObserver(function(e){var t,r=s(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n(a.addedNodes,function(e){return i.observe(e)}),n(a.removedNodes,function(e){return i.unobserve(e)})}}catch(o){r.e(o)}finally{r.f()}});return a.observe(r,{childList:!0,subtree:!0}),function(){a.disconnect(),i.disconnect()}},[]),t},ii=function(e,t,r,n,i,a,o,l,u,c){!function(e,t,r,n,i,a,o){var l=ni(e),u=function(){var t=e.current,s=l.current,u=s.left,c=s.top,d=s.visibleElementLeft,p=s.visibleElementTop,g=s.visibleElement;if(!t||!o||!g)return!1;var f=Mt(r,i,a),h=0===n;if(f.previous||!h)return!1;var v=u-d+g.offsetLeft,x=c-p+g.offsetTop;return t.scrollTo(v,x),!0};x.useEffect(function(){var t=e.current;if(!t||!o)return function(){};var r=!1,n=function(e,t){Array.from(e).filter(function(e){return e instanceof HTMLElement}).flatMap(function(e){return e instanceof HTMLImageElement?[e]:Array.from(e.querySelectorAll("img"))}).forEach(t)},i=new ResizeObserver(function(){r||(r=u())&&i.disconnect()}),a=new MutationObserver(function(e){var t,r=s(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n(a.addedNodes,function(e){return i.observe(e)}),n(a.removedNodes,function(e){return i.unobserve(e)})}}catch(o){r.e(o)}finally{r.f()}});return a.observe(t,{childList:!0,subtree:!0}),function(){a.disconnect(),i.disconnect()}},[t]),x.useLayoutEffect(function(){u()},[t])}(e,t,r,n,i,a,xt(o)),function(e,t){var r=ni(e),n=xt(t),i=vt(t);x.useEffect(function(){var t=e.current;if(!t||!n)return function(){};var a=function(e,t){return Array.from(e).filter(function(e){return e instanceof HTMLElement}).flatMap(function(e){return e instanceof HTMLImageElement?[e]:Array.from(e.querySelectorAll("img"))}).forEach(t)},o=new ResizeObserver(function(e){var n=r.current,a=n.left,o=n.top,s=n.visibleElement,l=n.visibleElementLeft,u=n.visibleElementTop;if(s&&e.filter(function(e){return e.target instanceof HTMLElement&&!(!e.target.clientWidth&&!e.target.clientHeight)&&(i?e.target.offsetTop<o:Math.abs(e.target.offsetLeft)<Math.abs(a))}).length){var c=a-l+s.offsetLeft,d=o-u+s.offsetTop;t.scrollTo(c,d)}}),l=new MutationObserver(function(e){var t,r=s(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;a(n.addedNodes,function(e){return o.observe(e)}),a(n.removedNodes,function(e){return o.unobserve(e)})}}catch(i){r.e(i)}finally{r.f()}});return l.observe(t,{childList:!0,subtree:!0}),function(){l.disconnect(),o.disconnect()}},[n,i])}(e,o),ri(o,c,u,n),ti(l,n,u),ti(o,n,u)},ai=f(f(f(f(f({},q.SINGLE_PAGE,_t.X),q.DOUBLE_PAGE,_t.X),q.CONTINUOUS_VERTICAL,_t.Y),q.CONTINUOUS_HORIZONTAL,_t.X),q.WEBTOON,_t.Y),oi=x.forwardRef(function(e,t){var r,n=e.currentPageIndex,i=e.pageToScrollToIndex,a=e.setPageToScrollToIndex,o=e.pages,s=e.totalPages,l=e.setPages,u=e.setPageLoadStates,c=e.setTotalPages,d=e.setCurrentPageIndex,p=e.transitionPageMode,f=e.retryFailedPagesKeyPrefix,v=e.setTransitionPageMode,m=e.readingMode,b=e.readingDirection,S=e.shouldUseInfiniteScroll,y=e.readerWidth,P=e.pageScaleMode,w=e.shouldOffsetDoubleSpreads,T=e.imagePreLoadAmount,E=e.pageGap,I=e.customFilter,D=e.shouldStretchPage,M=e.isStaticNav,O=e.readerNavBarWidth,k=e.setScrollbarXSize,N=e.setScrollbarYSize,B=e.isVisible,_=e.setIsVisible,W=e.updateCurrentPageIndex,z=e.showPreview,V=e.setShowPreview,H=e.initialChapter,F=e.currentChapter,U=e.chapters,G=e.visibleChapters,X=e.setReaderStateChapters,Z=e.isCurrentChapterReady,K=ae().direction,$=(null!==(r=Rt().state)&&void 0!==r?r:{resumeMode:kt.START}).resumeMode,Q=void 0===$?kt.START:$,ee=x.useRef(null),te=Mr(t,ee),re=vt(m),ne=xt(m),ie=Xn(ee),oe=ke();x.useEffect(function(){return oe.setScrollRef(ee)},[]);var se=At.useGetScrollbarSize("width",ee.current),le=At.useGetScrollbarSize("height",ee.current);x.useLayoutEffect(function(){k(se),N(le)},[se,le]);var ue=Y.useHandleClick(ee.current),ce=x.useRef(o.map(function(){return null})),de=h(x.useState({minChapterViewWidth:0,minChapterViewHeight:0,minChapterSizeSourceChapterId:-1}),2),pe=de[0],ge=pe.minChapterViewWidth,fe=pe.minChapterViewHeight,he=pe.minChapterSizeSourceChapterId,ve=de[1],xe=h(x.useState({}),2)[1],me=ai[m],be=b===R.LTR,Se=x.useMemo(function(){return U.findIndex(function(e){return e.id===(null==H?void 0:H.id)})},[U,null==H?void 0:H.id]),Ce=x.useMemo(function(){return U.slice(Math.max(0,Se-G.trailing),Math.min(U.length,Se+G.leading+1))},[U,Se,G.trailing,G.leading]),ye=x.useMemo(function(){return Ce.findIndex(function(e){return e.id===(null==F?void 0:F.id)})},[F,Ce]),je=x.useCallback(function(e,t,r){if(ne){var n=r===he;if(re){if(!n&&ge>=e)return;ve({minChapterViewWidth:e,minChapterViewHeight:0,minChapterSizeSourceChapterId:r})}else(n||fe<t)&&ve({minChapterViewWidth:0,minChapterViewHeight:t,minChapterSizeSourceChapterId:r})}},[ne,re,ge,fe,he]);if(function(e,t,r,n,i,a,o,s,l,u){x.useLayoutEffect(function(){if(null!=e){var c=L(e,r);if(o){var d=e>t?ut.PREVIOUS:ut.NEXT,p=s.current[c.pagesIndex];null==p||p.scrollIntoView({block:"start",inline:ct(d,l,u)})}var g=J(c),f=g===n-1;i(null),a(g,!f,f)}},[e])}(i,n,o,s,a,W,ne,ce,K,b),function(e,t,r,n,i){x.useLayoutEffect(function(){var e;t||null===(e=i.current)||void 0===e||e.scrollTo(lt(i.current,r,n),0)},[e])}(n,ne,K,b,ee),function(e){var t=x.useRef(void 0);x.useEffect(function(){var r=function(t){var r=e.current;r&&(r.style.cursor=t?"default":"none")},n=function(){r(!0),clearTimeout(t.current),t.current=setTimeout(function(){r(!1)},5e3)};return n(),window.addEventListener("mousemove",n),function(){r(!0),window.removeEventListener("mousemove",n),clearTimeout(t.current)}},[])}(ee),function(e,t,r){x.useEffect(function(){if(e!==q.CONTINUOUS_HORIZONTAL)return function(){};if(!r.current)return function(){};var n,i,a,o=function(e){var o;if(!0!==a){e.preventDefault();var s,l=!Math.abs(Math.abs(null!=n?n:e.deltaX)-Math.abs(e.deltaX)),u=!Math.abs(Math.abs(null!=i?i:e.deltaY)-Math.abs(e.deltaY));n=e.deltaX,i=e.deltaY,a||(a=!l||!u),void 0!==a&&(e.shiftKey?null===(s=r.current)||void 0===s||s.scrollBy({top:e.deltaY}):null===(o=r.current)||void 0===o||o.scrollBy({left:t===R.LTR?e.deltaY:-1*e.deltaY}))}};return r.current.addEventListener("wheel",o),function(){var e;return null===(e=r.current)||void 0===e?void 0:e.removeEventListener("wheel",o)}},[e,t])}(m,b,ee),function(e,t,r,n,i){x.useEffect(function(){var a,o,s=function(){e&&t(!1),r&&n(!1)};return null===(a=i.current)||void 0===a||a.addEventListener("wheel",s),null===(o=i.current)||void 0===o||o.addEventListener("touchmove",s),function(){var e,t;null===(e=i.current)||void 0===e||e.removeEventListener("wheel",s),null===(t=i.current)||void 0===t||t.removeEventListener("touchmove",s)}},[e,r])}(B,_,z,V,ee),function(e,t,r){x.useEffect(function(){!e||r?t.resume():t.pause()},[e,t.isPaused,r])}(B,oe,M),ii(ee,null==F?void 0:F.id,ye,n,Ce,G,m,b,a,P),x.useLayoutEffect(function(){ve({minChapterViewWidth:0,minChapterViewHeight:0,minChapterSizeSourceChapterId:-1}),xe({})},[m]),!H||!F)throw new Error("ReaderViewer: illegal state - initialChapter and currentChapter should not be undefined");return C.jsx(A,{ref:te,sx:g(g({width:"100%",height:"100%",overflow:"auto",flexWrap:"nowrap"},j(re&&Dt(y,P),{alignItems:"center"})),j(!re,g(g({},j("ltr"===K,{flexDirection:be?"row":"row-reverse"})),j("rtl"===K,{flexDirection:be?"row-reverse":"row"})))),onClick:function(e){return!ie&&ue(e)},onScroll:function(){return Y.updateCurrentPageOnScroll(ce,s-1,W,me,b)},children:Ce.map(function(e,t){var r,i,o,s,g=Math.max(0,Ce.length-t-1),h=Ce[g],x=null!==(r=Ce[g+1])&&void 0!==r?r:U[Se+G.leading+1],j=null!==(i=Ce[g-1])&&void 0!==i?i:U[Se-G.trailing-1],M=h.id===H.id,L=h.id===F.id,R=h.id===(null===(o=Ce[ye+1])||void 0===o?void 0:o.id),k=h.id===(null===(s=Ce[ye-1])||void 0===s?void 0:s.id),A=H.sourceOrder>h.sourceOrder,N=H.sourceOrder<h.sourceOrder,B=G.lastLeadingChapterSourceOrder===h.sourceOrder,_=G.lastTrailingChapterSourceOrder===h.sourceOrder,z=B&&G.isLeadingChapterPreloadMode||_&&G.isTrailingChapterPreloadMode,V=Mt(g,Ce,G),Y=h.id===he;return C.jsx(ei,{chapterId:h.id,previousChapterId:null==x?void 0:x.id,nextChapterId:null==j?void 0:j.id,isPreviousChapterVisible:V.previous,isNextChapterVisible:V.next,lastPageRead:_e(h.lastPageRead,0,h.pageCount-1),currentPageIndex:Bt(n,h,F,L,Z,A,N,G),isInitialChapter:M,isCurrentChapter:L,isPreviousChapter:R,isNextChapter:k,isLeadingChapter:A,isTrailingChapter:N,isPreloadMode:z,imageRefs:ce,setPages:l,setPageLoadStates:u,setTotalPages:c,setCurrentPageIndex:d,setPageToScrollToIndex:a,transitionPageMode:p,retryFailedPagesKeyPrefix:f,readingMode:m,readerWidth:y,pageScaleMode:P,shouldOffsetDoubleSpreads:w,readingDirection:b,shouldUseInfiniteScroll:S,updateCurrentPageIndex:L?W:ft,scrollIntoView:L&&G.scrollIntoView,resumeMode:Nt(L,M,A,N,G.resumeMode,Q),setReaderStateChapters:X,setTransitionPageMode:v,pageGap:E,imagePreLoadAmount:T,customFilter:I,shouldStretchPage:D,scrollbarXSize:se,scrollbarYSize:le,readerNavBarWidth:O,onSizeChange:je,minWidth:Y?0:ge,minHeight:Y?0:fe,scrollElement:ee.current},h.id)})})}),si=T(x.memo(oi),[M,S.useSettingsWithoutDefaultFlag,E,nt,function(){return{updateCurrentPageIndex:Y.useUpdateCurrentPageIndex()}},at,Ue,I],["currentPageIndex","pageToScrollToIndex","setPageToScrollToIndex","pages","totalPages","setPages","setPageLoadStates","setTotalPages","setCurrentPageIndex","retryFailedPagesKeyPrefix","setTransitionPageMode","readingMode","readingDirection","shouldUseInfiniteScroll","readerWidth","pageScaleMode","shouldOffsetDoubleSpreads","imagePreLoadAmount","pageGap","customFilter","shouldStretchPage","isStaticNav","readerNavBarWidth","transitionPageMode","setScrollbarXSize","setScrollbarYSize","isVisible","setIsVisible","updateCurrentPageIndex","showPreview","setShowPreview","initialChapter","currentChapter","chapters","visibleChapters","setReaderStateChapters","isCurrentChapterReady"]),li=Object.fromEntries(Object.values(m).map(function(e){return[e,{scopes:e}]})),ui=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t[1],a=t[2],o=t[3];return Ht(n,i,g(g({},a),li.reader),o)},ci=function(e,t,r,n,i,a,o){if(a)e(r,i[0]);else{var s=sn(i.indexOf(n),i,o);void 0===s?t(r):e(r,s)}},di=function(e){var t=e.scrollElementRef,r=ae().direction,n=S.useGetThemeDirection(),i=p(),a=i.enableScope,o=i.disableScope,s=b().manga,l=nt(),u=l.isVisible,c=l.setIsVisible,d=S.useSettings(),f=d.hotkeys,h=d.pageScaleMode,v=d.shouldStretchPage,C=d.shouldOffsetDoubleSpreads,y=d.readingMode,j=d.readingDirection,P=d.autoScroll,w=d.scrollAmount,T=ke(),E=at().setShowPreview,I=S.useExit(),D=Y.useOpenChapter(),M=Y.useOpenPage(),L=S.useCreateUpdateSetting(null!=s?s:We),O=S.useCreateDeleteSetting(null!=s?s:We);return ui(f[Wt.PREVIOUS_PAGE],function(){return M("previous")},[M]),ui(f[Wt.NEXT_PAGE],function(){return M("next")},[M]),ui(f[Wt.SCROLL_BACKWARD],function(){T.isActive?T.setDirection(zt.BACKWARD):t.current&&Y.scroll(zt.BACKWARD,Vt[y.value],y.value,j.value,r,t.current,D,c,E,w)},{preventDefault:!0},[y.value,j.value,r,D,w,T.isActive]),ui(f[Wt.SCROLL_FORWARD],function(){T.isActive?T.setDirection(zt.FORWARD):t.current&&Y.scroll(zt.FORWARD,Vt[y.value],y.value,j.value,r,t.current,D,c,E,w)},{preventDefault:!0},[y.value,j.value,r,D,w,T.isActive]),ui(f[Wt.PREVIOUS_CHAPTER],function(){return D(K("previous","next",n))},[D,n]),ui(f[Wt.NEXT_CHAPTER],function(){return D(K("next","previous",n))},[D,n]),ui(f[Wt.TOGGLE_MENU],function(){return c(!u)},[u]),ui(f[Wt.CYCLE_SCALE_TYPE],function(){ci(L,O,"pageScaleMode",h.value,Ee,h.isDefault,!0)},[L,O,h.value,h.isDefault]),ui(f[Wt.STRETCH_IMAGE],function(){return L("shouldStretchPage",!v.value)},[L,v.value]),ui(f[Wt.OFFSET_SPREAD_PAGES],function(){return L("shouldOffsetDoubleSpreads",!C.value)},[L,C.value]),ui(f[Wt.CYCLE_READING_MODE],function(){ci(L,O,"readingMode",y.value,De,y.isDefault,!0)},[L,O,y.value,y.isDefault]),ui(f[Wt.CYCLE_READING_DIRECTION],function(){ci(L,O,"readingDirection",j.value,Re,j.isDefault,!0)},[L,O,j.value,j.isDefault]),ui(f[Wt.TOGGLE_AUTO_SCROLL],T.toggleActive,{preventDefault:!0},[T.toggleActive]),ui(f[Wt.AUTO_SCROLL_SPEED_DECREASE],function(){return L("autoScroll",g(g({},P),{},{value:Math.min(Ne.max,P.value+Ne.step)}))},[L,P.value]),ui(f[Wt.AUTO_SCROLL_SPEED_INCREASE],function(){return L("autoScroll",g(g({},P),{},{value:Math.max(Ne.min,P.value-Ne.step)}))},[L,P.value]),ui(f[Wt.EXIT_READER],I,[I]),x.useEffect(function(){return a(m.READER),function(){return o(m.READER)}},[]),null};e("Reader",T(x.memo(function(e){var t,r,n,i=e.setOverride,a=e.readerNavBarWidth,o=e.isVisible,s=e.setIsVisible,l=e.manga,u=e.setManga,c=e.shouldSkipDupChapters,d=e.shouldSkipFilteredChapters,p=e.backgroundColor,f=e.readingMode,v=e.tapZoneLayout,m=e.tapZoneInvertMode,b=e.shouldShowReadingModePreview,S=e.shouldShowTapZoneLayoutPreview,y=e.setSettings,j=e.mangaChapters,P=e.initialChapter,w=e.chapterForDuplicatesHandling,T=e.currentChapter,E=e.setReaderStateChapters,I=e.setTotalPages,D=e.setCurrentPageIndex,M=e.setPageToScrollToIndex,L=e.setPages,O=e.setPageUrls,R=e.setPageLoadStates,k=e.setTransitionPageMode,A=e.cancelAutoScroll,B=e.setShowPreview,_=fe().t,W=x.useRef(null),z=h(x.useState(!1),2),V=z[0],H=z[1],F=$t(),U=F.chapterSourceOrder,G=F.mangaId,X=Number(U),Y=Number(G),Z=Xe.useGetManga(Qt,Y),K=Xe.useGetMangaChapters(er,Y);Lr(l&&T?"".concat(l.title,": ").concat(T.name):_("reader.title",{mangaId:Y,chapterIndex:X}));var J=tr(),$=J.metadata,Q=J.settings,ee=J.request,te=xr(null!=l?l:We),re=void 0===T||!V||Z.loading||K.loading||ee.loading,ne=null!==(t=null!==(r=Z.error)&&void 0!==r?r:K.error)&&void 0!==t?t:ee.error;return x.useEffect(function(){var e;u(null===(e=Z.data)||void 0===e?void 0:e.manga)},[null===(n=Z.data)||void 0===n?void 0:n.manga]),function(e,t,r,n,i,a,o,s,l,u,c,d){x.useEffect(function(){return function(){e(void 0),t(Ft),r(0),n(null),i(0),a([Ut("",0)]),o([]),s([{url:"",loaded:!1}]),l(gt.NONE),u(!1),c(Gt),d()}},[])}(u,E,D,M,I,L,O,R,k,s,y,A),function(e,t,r,n,i,a){var o;x.useEffect(function(){var o,s=null===(o=e.data)||void 0===o?void 0:o.manga;if(s&&!t.loading&&!t.error){var l=Xt(s,r),u=Yt(s,l.shouldUseAutoWebtoonMode,l.readingMode),c=g(g({},r),{},{readingMode:u?q.WEBTOON:r.readingMode}),d=u?q.WEBTOON:l.readingMode.value,p=Zt("global",{meta:n},c,void 0,d),f=Xt(s,p);i(f),a(!0)}},[null===(o=e.data)||void 0===o?void 0:o.manga,r])}(Z,ee,Q,$,y,H),function(e,t,r,n,i,a,o,s,l){var u=fe().t,c=x.useRef(void 0),d=x.useRef(void 0),p=x.useRef(void 0),g=x.useRef(!0);x.useEffect(function(){if(!e&&!t&&r){var f=JSON.stringify(n)!==JSON.stringify(c.current);o&&f&&tt(u(Ie[n.value].title),{autoHideDuration:5e3}),c.current=n;var h=JSON.stringify(i)!==JSON.stringify(d.current)||JSON.stringify(a)!==JSON.stringify(p.current);s&&h&&(l(!0),g.current&&setTimeout(function(){return l(!1)},5e3)),d.current=i,p.current=a,g.current=!1}},[e,t,r,n.value,n.isDefault,i.value,i.isDefault,a.value,a.isDefault])}(re,ne,V,f,v,m,b,S,B),function(e,t,r,n,i,a,o,s,l){var u,c=qt(),d=Rt().state,p=(null!=d?d:{}).updateInitialChapter?void 0:n;x.useEffect(function(){var n,u,f=null===(n=e.data)||void 0===n?void 0:n.chapters.nodes,h=f?null!==(u=f[f.length-t])&&void 0!==u?u:null:void 0,v=null!=p?p:h,x=null!=i?i:h,m=function(){if(!f||!x)return[];var e=s?vr(null!=r?r:f,l):f;return(o?He.removeDuplicates(x,e):e).map(function(e){return Kt(e.id)})}(),b=h&&He.getNextChapter(h,m,{offset:ut.NEXT}),S=h&&He.getNextChapter(h,m,{offset:ut.PREVIOUS}),C=null!=v&&v.id!==(null==p?void 0:p.id);C&&c("",{replace:!0,state:g(g({},d),{},{updateInitialChapter:void 0})}),a(function(e){var t,r,n,i,a=(null==h?void 0:h.id)!==(null===(t=e.currentChapter)||void 0===t?void 0:t.id);return g(g({},e),{},{mangaChapters:null!==(r=e.mangaChapters)&&void 0!==r?r:f,chapters:m,initialChapter:v,chapterForDuplicatesHandling:x,currentChapter:h,nextChapter:b,previousChapter:S,isCurrentChapterReady:!a&&e.isCurrentChapterReady,visibleChapters:C?g(g({},Ft.visibleChapters),{},{lastLeadingChapterSourceOrder:null!==(n=null==v?void 0:v.sourceOrder)&&void 0!==n?n:Ft.visibleChapters.lastLeadingChapterSourceOrder,lastTrailingChapterSourceOrder:null!==(i=null==v?void 0:v.sourceOrder)&&void 0!==i?i:Ft.visibleChapters.lastTrailingChapterSourceOrder,isLeadingChapterPreloadMode:!1,isTrailingChapterPreloadMode:!1,scrollIntoView:!!e.initialChapter}):e.visibleChapters})})},[null===(u=e.data)||void 0===u?void 0:u.chapters.nodes,t,o,s,p,l])}(K,X,j,P,w,E,c,d,te),x.useLayoutEffect(function(){return i({status:!0,value:C.jsxs(N,{sx:{position:"absolute"},children:[C.jsx(di,{scrollElementRef:W}),C.jsx(Hn,{isVisible:o}),!W.current&&C.jsx(N,{onClick:function(){return s(!o)},sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"transparent"}})]})}),function(){return i({status:!1,value:null})}},[o,s,W.current]),ne?C.jsx(Ir,{message:_("global.error.label.failed_to_load_data"),messageExtra:It(ne),retry:function(){Z.error&&Z.refetch().catch(wt()),ee.error&&ee.refetch().catch(wt()),K.error&&K.refetch().catch(wt())}}):re?C.jsx(N,{sx:{height:"100vh",width:"100vw",display:"grid",placeItems:"center"},children:C.jsx(Ke,{})}):null===T?C.jsx(Ir,{message:_("reader.error.label.chapter_not_found")}):l&&T?C.jsxs(N,{sx:{position:"relative",display:"flex",flexDirection:"column",width:"calc(100vw - ".concat(a,"px)"),height:"100vh",marginLeft:"".concat(a,"px"),transition:function(e){return"width 0.".concat(e.transitions.duration.shortest,"s, margin-left 0.").concat(e.transitions.duration.shortest,"s")},overflow:"auto",backgroundColor:bt[p]},children:[C.jsx(si,{ref:W}),C.jsx(Un,{}),C.jsx(Gn,{})]}):null}),[I,nt,b,Ue,Jt,function(){var e=S.useSettingsWithoutDefaultFlag();return{shouldSkipDupChapters:e.shouldSkipDupChapters,shouldSkipFilteredChapters:e.shouldSkipFilteredChapters,backgroundColor:e.backgroundColor,shouldShowReadingModePreview:e.shouldShowReadingModePreview,shouldShowTapZoneLayoutPreview:e.shouldShowTapZoneLayoutPreview}},function(){var e=S.useSettings();return{readingMode:e.readingMode,tapZoneLayout:e.tapZoneLayout,tapZoneInvertMode:e.tapZoneInvertMode}},M,function(){return{cancelAutoScroll:ke().cancel}},at],["setOverride","readerNavBarWidth","isVisible","setIsVisible","manga","setManga","shouldSkipDupChapters","shouldSkipFilteredChapters","backgroundColor","readingMode","tapZoneLayout","tapZoneInvertMode","shouldShowReadingModePreview","shouldShowTapZoneLayoutPreview","setSettings","mangaChapters","initialChapter","chapterForDuplicatesHandling","currentChapter","setReaderStateChapters","setTotalPages","setCurrentPageIndex","setPageToScrollToIndex","setPages","setPageUrls","setPageLoadStates","setTransitionPageMode","cancelAutoScroll","setShowPreview"]))}}})}();
