!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?t(Object(a),!0).forEach(function(t){n(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function n(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,r||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function l(r,n,a,o){var l=n&&n.prototype instanceof s?n:s,u=Object.create(l.prototype);return i(u,"_invoke",function(r,n,a){var i,o,l,s=0,u=a||[],d=!1,g={p:0,n:0,v:e,a:b,f:b.bind(e,4),d:function(t,r){return i=t,o=0,l=e,g.n=r,c}};function b(r,n){for(o=r,l=n,t=0;!d&&s&&!a&&t<u.length;t++){var a,i=u[t],b=g.p,f=i[2];r>3?(a=f===n)&&(l=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=e):i[0]<=b&&((a=r<2&&b<i[1])?(o=0,g.v=n,g.n=i[1]):b<f&&(a=r<3||i[0]>n||n>f)&&(i[4]=r,i[5]=n,g.n=f,o=0))}if(a||r>1)return c;throw d=!0,n}return function(a,u,f){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&b(u,f),o=u,l=f;(t=o<2?e:l)||!d;){i||(o?o<3?(o>1&&(g.n=-1),b(o,l)):g.n=l:g.v=l);try{if(s=2,i){if(o||(a="next"),t=i[a]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=i.return)&&t.call(i),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=e}else if((t=(d=g.n<0)?l:r.call(n,g))!==c)break}catch(t){i=e,o=1,l=t}finally{s=1}}return{value:t,done:d}}}(r,a,o),!0),u}var c={};function s(){}function u(){}function d(){}t=Object.getPrototypeOf;var g=[][n]?t(t([][n]())):(i(t={},n,function(){return this}),t),b=d.prototype=s.prototype=Object.create(g);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,o,"GeneratorFunction")),e.prototype=Object.create(b),e}return u.prototype=d,i(b,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,o,"GeneratorFunction"),i(b),i(b,o,"Generator"),i(b,n,function(){return this}),i(b,"toString",function(){return"[object Generator]"}),(a=function(){return{w:l,m:f}})()}function i(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}i=function(e,t,r,n){function o(t,r){i(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))},i(e,t,r,n)}function o(e,t,r,n,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function l(e){o(i,n,a,l,c,"next",e)}function c(e){o(i,n,a,l,c,"throw",e)}l(void 0)})}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./index-legacy-DbvsbuFI.js","./CategoriesInclusionSetting-legacy-DaF53Et-.js","./CheckboxInput-legacy-DOO1YABB.js","./NumberSetting-legacy-Bm02wQ7l.js","./usePersistedValue-legacy-DP4TJtF4.js","./Switch-legacy-DtSfVgi4.js","./ListSubheader-legacy-D6CTP6K_.js","./EmptyViewAbsoluteCentered-legacy-CZb4FyHT.js","./useAppTitle-legacy-oE1eilGc.js","./ThreeStateCheckboxInput-legacy-vZt-HlJP.js","./Checkbox-legacy-Do2WUkle.js","./SwitchBase-legacy-WgGrSGAu.js","./Slider-legacy-Dx30W6c-.js"],function(e,t){"use strict";var i,o,s,u,d,g,b,f,p,y,h,v,j,m,x,S,_,C,w,O,k,P,U,T,I,N,A,E,F,G,M,V,D,L,R,q,B;return{setters:[function(e){i=e.u,o=e.r,s=e.b,u=e.j,d=e.aS,g=e.p,b=e.i,f=e.k,p=e.n,y=e.bv,h=e.q,v=e.B,j=e.aA,m=e.m,x=e.g,S=e.H,_=e.o,C=e.bw,w=e.b4,O=e.a,k=e.e,P=e.f,U=e.aP,T=e.A,I=e.y,N=e.bx,A=e.a2},function(e){E=e.C,F=e.a},function(e){G=e.C},function(e){M=e.N},function(e){V=e.u,D=e.g},function(e){L=e.S},function(e){R=e.L},function(e){q=e.E},function(e){B=e.u},null,null,null,null],execute:function(){e("LibrarySettings",function(){var e,t,r,n,a=i().t;B(a("library.title"));var l=o.useGetCategories(w),c=o.useGetServerSettings({notifyOnNetworkStatusChange:!0}),s=O(),b=s.settings,f=s.loading,p=s.request,y=p.error,h=p.refetch,v=I(function(e){return m(a("search.error.label.failed_to_save_settings"),"error",x(e))}),j=(null!==(e=null===(t=l.data)||void 0===t?void 0:t.categories.nodes.length)&&void 0!==e?e:1)-1;if(c.loading||f||l.loading)return u.jsx(k,{});var C=null!==(r=null!==(n=c.error)&&void 0!==n?n:y)&&void 0!==r?r:l.error;if(C)return u.jsx(q,{message:a("global.error.label.failed_to_load_data"),messageExtra:x(C),retry:function(){c.error&&(null==c||c.refetch().catch(P())),y&&h().catch(P()),l.error&&l.refetch().catch(P())}});return u.jsxs(S,{sx:{pt:0},children:[u.jsxs(S,{subheader:u.jsx(R,{component:"div",id:"library-category-settings",children:a("category.title.category_other")}),children:[u.jsx(U,{to:T.settings.childRoutes.categories.path,children:u.jsx(g,{primary:a("category.dialog.title.edit_category_other"),secondary:a("category.value",{count:j})})}),u.jsxs(_,{children:[u.jsx(g,{primary:a("library.settings.general.add_to_library.category_selection.label.title"),secondary:a("library.settings.general.add_to_library.category_selection.label.description")}),u.jsx(L,{edge:"end",checked:b.showAddToLibraryCategorySelectDialog,onChange:function(e){return v("showAddToLibraryCategorySelectDialog",e.target.checked)}})]}),u.jsxs(_,{children:[u.jsx(g,{primary:a("library.settings.general.remove_from_library.remove_from_categories.label.title"),secondary:a("library.settings.general.remove_from_library.remove_from_categories.label.description")}),u.jsx(L,{edge:"end",checked:b.removeMangaFromCategories,onChange:function(e){return v("removeMangaFromCategories",e.target.checked)}})]})]}),u.jsx(S,{subheader:u.jsx(R,{component:"div",id:"library-general-settings",children:a("global.label.general")}),children:u.jsxs(_,{children:[u.jsx(g,{primary:a("library.settings.general.search.ignore_filters.label.title"),secondary:a("library.settings.general.search.ignore_filters.label.description")}),u.jsx(L,{edge:"end",checked:b.ignoreFilters,onChange:function(e){return v("ignoreFilters",e.target.checked)}})]})}),u.jsx(W,{serverSettings:c.data.settings,categories:l.data.categories.nodes}),u.jsxs(S,{subheader:u.jsx(R,{component:"div",id:"library-advanced",children:a("global.label.advanced")}),children:[u.jsx(d,{onClick:function(){return $()},children:u.jsx(g,{primary:a("library.settings.advanced.database.cleanup.label.title"),secondary:a("library.settings.advanced.database.cleanup.label.description")})}),u.jsx(U,{to:T.settings.childRoutes.library.childRoutes.duplicates.path,children:u.jsx(g,{primary:a("library.settings.advanced.duplicates.label.title"),secondary:a("library.settings.advanced.duplicates.label.description")})})]})]})});var t=function(e){var t=[];return e.excludeUnreadChapters&&t.push(j(y.excludeUnreadChapters)),e.excludeNotStarted&&t.push(j(y.excludeNotStarted)),e.excludeCompleted&&t.push(j(y.excludeCompleted)),!t.length&&t.push(j("global.label.none")),t.join(", ")},z=function(e){var j=e.serverSettings,S=i().t,_=function(e){return{excludeCompleted:e.excludeCompleted,excludeNotStarted:e.excludeNotStarted,excludeUnreadChapters:e.excludeUnreadChapters}}(j),C=c(o.useUpdateServerSettings(),1)[0],w=c(s.useState(null!=_?_:{}),2),O=w[0],k=w[1],P=c(s.useState(!1),2),U=P[0],T=P[1],I=t(_),N=function(){var e=l(a().m(function e(){var t,r;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=(null==_?void 0:_.excludeCompleted)!==O.excludeCompleted||_.excludeNotStarted!==O.excludeNotStarted||_.excludeUnreadChapters!==O.excludeUnreadChapters,T(!1),t){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,C({variables:{input:{settings:O}}});case 2:e.n=4;break;case 3:e.p=3,r=e.v,m(S("global.error.label.failed_to_save_changes"),"error",x(r));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),A=function(){k(null!=_?_:{}),T(!1)};return s.useEffect(function(){_&&k(_)},[null==_?void 0:_.excludeCompleted,null==_?void 0:_.excludeNotStarted,null==_?void 0:_.excludeUnreadChapters]),u.jsxs(u.Fragment,{children:[u.jsx(d,{onClick:function(){return T(!0)},children:u.jsx(g,{primary:S("library.settings.global_update.entries.title"),secondary:I,onClick:function(){return T(!0)}})}),u.jsxs(b,{open:U,onClose:A,children:[u.jsx(f,{children:S("library.settings.global_update.entries.title")}),u.jsx(p,{children:u.jsx(E,{children:Object.entries(O).map(function(e){var t=c(e,2),a=t[0],i=t[1];return u.jsx(G,{label:S(y[a]),checked:i,onChange:function(e,t){k(r(r({},O),{},n({},a,t)))}},a)})})}),u.jsxs(h,{children:[u.jsx(v,{onClick:A,color:"primary",children:S("global.button.cancel")}),u.jsx(v,{onClick:N,color:"primary",children:S("global.button.ok")})]})]})]})},H=function(e){var t=e.globalUpdateInterval,r=i().t,n=t,a=!!n,l=c(o.useUpdateServerSettings(),1)[0],d=c(V("lastGlobalUpdateInterval",C.default,n,D),2),b=d[0],f=d[1],p=s.useCallback(function(e){f(0===e?b:e),l({variables:{input:{settings:{globalUpdateInterval:e}}}})},[b]);return u.jsxs(S,{children:[u.jsxs(_,{children:[u.jsx(g,{primary:r("library.settings.global_update.auto_update.label.title")}),u.jsx(L,{edge:"end",checked:a,onChange:function(e){return t=e.target.checked,void p(t?b:0);var t}})]}),u.jsx(M,{settingTitle:r("library.settings.global_update.auto_update.interval.label.title"),settingValue:r("library.settings.global_update.auto_update.interval.label.value",{hours:b}),value:b,minValue:C.min,maxValue:C.max,defaultValue:C.default,showSlider:!0,valueUnit:r("global.time.hour_short"),handleUpdate:p,disabled:!a})]})},W=function(e){var t=e.serverSettings,r=e.categories,s=i().t,d=t.updateMangas,b=c(o.useUpdateServerSettings(),1)[0],f=function(){var e=l(a().m(function e(t,r){var i;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,b({variables:{input:{settings:n({},t,r)}}});case 1:e.n=3;break;case 2:e.p=2,i=e.v,m(s("global.error.label.failed_to_save_changes"),"error",x(i));case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t,r){return e.apply(this,arguments)}}();return u.jsxs(S,{subheader:u.jsx(R,{component:"div",id:"global-update-settings",children:s("library.settings.global_update.title")}),children:[u.jsx(H,{globalUpdateInterval:t.globalUpdateInterval}),u.jsx(z,{serverSettings:t}),u.jsx(F,{categories:r,includeField:"includeInUpdate",dialogText:s("library.settings.global_update.categories.label.info")}),u.jsxs(_,{children:[u.jsx(g,{primary:s("library.settings.global_update.metadata.label.title"),secondary:s("library.settings.global_update.metadata.label.description")}),u.jsx(L,{edge:"end",checked:d,onChange:function(e){return f("updateMangas",e.target.checked)}})]})]})},$=function(){var e=l(a().m(function e(){var t,r,n;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,o.getMangas(N,{filter:{inLibrary:{equalTo:!1},categoryId:{isNull:!1}}},{fetchPolicy:"no-cache"}).response;case 1:if(t=e.v,!(r=A.getIds(t.data.mangas.nodes)).length){e.n=2;break}return e.n=2,o.updateMangasCategories(r,{clearCategories:!0}).response;case 2:m(j("library.settings.advanced.database.cleanup.label.success"),"success"),e.n=4;break;case 3:e.p=3,n=e.v,m(j("library.settings.advanced.database.cleanup.label.error"),"error",x(n));case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}()}}})}();
