import{c as _,j as e,aV as u,S as R,T as H,B as N,aA as h,aM as B,aE as O,u as q,r as p,e as D,g as G,f as S,H as m,o as g,p as c,aW as $,aX as W,aP as k}from"./index-B3NSCdsi.js";import{E as X}from"./EmptyViewAbsoluteCentered-DBqm8ISe.js";import{D as J}from"./Download-CPjWlyL3.js";import{u as K}from"./useAppTitle-CiigzFb7.js";import{L as y}from"./ListSubheader-Ddg_DhEe.js";const Q=_(e.jsx("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"})),Y=_(e.jsx("path",{d:"M18.32 4.26C16.84 3.05 15.01 2.25 13 2.05v2.02c1.46.18 2.79.76 3.9 1.62zM19.93 11h2.02c-.2-2.01-1-3.84-2.21-5.32L18.31 7.1c.86 1.11 1.44 2.44 1.62 3.9m-1.62 5.9 1.43 1.43c1.21-1.48 2.01-3.32 2.21-5.32h-2.02c-.18 1.45-.76 2.78-1.62 3.89M13 19.93v2.02c2.01-.2 3.84-1 5.32-2.21l-1.43-1.43c-1.1.86-2.43 1.44-3.89 1.62M13 12V7h-2v5H7l5 5 5-5zm-2 7.93v2.02c-5.05-.5-9-4.76-9-9.95s3.95-9.45 9-9.95v2.02C7.05 4.56 4 7.92 4 12s3.05 7.44 7 7.93"})),Z=(r,i,t,s=!1)=>t===u.Downloading?e.jsx(Y,{}):r?e.jsx(B,{size:15}):!i||t===u.Error?e.jsx(O,{}):s?e.jsx(Q,{}):e.jsx(J,{}),ee=(r,i,t,s,b=0)=>s===u.Downloading?h("global.update.label.updating",{progress:b}):s===u.Error?h("global.update.label.update_failure"):r?h("global.update.label.checking"):t?h("global.update.label.check_failure"):i?h("global.update.label.available"):h("global.update.label.up_to_date"),L=({version:r,isCheckingForUpdate:i,isUpdateAvailable:t,updateCheckError:s,checkForUpdate:b,triggerUpdate:o,updateState:l,progress:j,downloadAsLink:f,url:n})=>{const x=l===u.Downloading,v=()=>{if(x)return;if(!t||s||l===u.Error){b();return}t&&(o==null||o())};return e.jsxs(R,{sx:{alignItems:"start"},children:[e.jsx(H,{component:"span",variant:"body2",children:r}),e.jsx(N,{sx:{marginTop:"5px",backgroundColor:"transparent",pointerEvents:x?"none":"unset"},size:"small",variant:"outlined",startIcon:Z(i,t,l,f),onClick:v,...n&&t?{href:n,target:"_blank"}:void 0,children:ee(i,t,s,l,j)})]})};function ne(){var C,F,E;const{t:r}=q();K(r("settings.about.title"));const{data:i,loading:t,error:s,refetch:b}=p.useGetAbout({notifyOnNetworkStatusChange:!0}),{data:o,loading:l,refetch:j,error:f}=p.useCheckForServerUpdate({notifyOnNetworkStatusChange:!0}),{data:n,loading:x,refetch:v,error:I}=p.useCheckForWebUIUpdate({notifyOnNetworkStatusChange:!0}),T=I||(n==null?void 0:n.checkForWebUIUpdate.tag)==="",{data:U}=p.useGetWebUIUpdateStatus(),{state:M,progress:P}=(C=U==null?void 0:U.getWebUIUpdateStatus)!=null?C:{state:u.Idle,progress:0};if(t)return e.jsx(D,{});if(s)return e.jsx(X,{message:r("global.error.label.failed_to_load_data"),messageExtra:G(s),retry:()=>b().catch(S())});const{aboutServer:a,aboutWebUI:w}=i,d=(F=o==null?void 0:o.checkForServerUpdates)==null?void 0:F.find(z=>z.channel===a.buildType),V=!!(d!=null&&d.tag)&&d.tag!==a.version,A=!!(n!=null&&n.checkForWebUIUpdate.updateAvailable);return e.jsxs(m,{sx:{pt:0},children:[e.jsxs(m,{sx:{padding:0},subheader:e.jsx(y,{component:"div",id:"about-server-info",children:r("settings.server.title.server")}),children:[e.jsx(g,{children:e.jsx(c,{primary:r("settings.server.title.server"),secondary:"".concat(a.name," (").concat(a.buildType,")")})}),e.jsx(g,{children:e.jsx(c,{primary:r("settings.about.server.label.version"),secondary:e.jsx(L,{version:a.version,isCheckingForUpdate:l,isUpdateAvailable:V,updateCheckError:f,checkForUpdate:j,downloadAsLink:!0,url:(E=d==null?void 0:d.url)!=null?E:""})})}),e.jsx(g,{children:e.jsx(c,{primary:r("settings.about.server.label.build_time"),secondary:$(Number(a.buildTime)).toString()})})]}),e.jsx(W,{}),e.jsxs(m,{sx:{padding:0},subheader:e.jsx(y,{component:"div",id:"about-webui-info",children:r("settings.webui.title.webui")}),children:[e.jsx(g,{children:e.jsx(c,{primary:r("settings.about.webui.label.channel"),secondary:w.channel.toLocaleUpperCase()})}),e.jsx(g,{children:e.jsx(c,{primary:r("settings.about.webui.label.version"),secondary:e.jsx(L,{version:w.tag,isCheckingForUpdate:x,isUpdateAvailable:A,updateCheckError:T,checkForUpdate:v,triggerUpdate:()=>p.updateWebUI().response.catch(S()),progress:P,updateState:M})})})]}),e.jsx(W,{}),e.jsxs(m,{subheader:e.jsx(y,{component:"div",id:"about-links",children:r("global.label.links")}),children:[e.jsx(k,{to:a.github,target:"_blank",rel:"noreferrer",children:e.jsx(c,{primary:r("settings.about.server.label.github"),secondary:a.github})}),e.jsx(k,{to:"https://github.com/Suwayomi/Suwayomi-WebUI",target:"_blank",rel:"noreferrer",children:e.jsx(c,{primary:r("settings.about.webui.label.github"),secondary:"https://github.com/Suwayomi/Suwayomi-WebUI"})}),e.jsx(k,{to:a.discord,target:"_blank",rel:"noreferrer",children:e.jsx(c,{primary:r("global.label.discord"),secondary:a.discord})})]})]})}export{ne as About};
